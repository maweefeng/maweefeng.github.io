<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>  
	  
  	iOS开发技巧 - 黑猫也紧张
  	
	</title>

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="atom.xml" rel="alternate" title="黑猫也紧张" type="application/atom+xml">

	<link href="asset/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="asset/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<script src="asset/javascripts/jquery.min.js"></script>
	<script src="asset/highlightjs/highlight.pack.js"></script>
	<link href="asset/highlightjs/styles/solarized_dark.css" media="screen, projection" rel="stylesheet" type="text/css">
<script>hljs.initHighlightingOnLoad();</script>

	<!--[if lt IE 9]><script src="asset/javascripts/html5.js"></script><![endif]-->
	<!-- <link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'> -->
	<style type="text/css">
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 300;
  src: local('Nunito-Light'), url(asset/font/1TiHc9yag0wq3lDO9cw0voX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 400;
  src: local('Nunito-Regular'), url(asset/font/6TbRXKWJjpj6V2v_WyRbMX-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 700;
  src: local('Nunito-Bold'), url(asset/font/TttUCfJ272GBgSKaOaD7KoX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
	</style>
	
	<style type="text/css">
	.container .left-col{ opacity: 1;}
	#pagenavi a{ font-size: 1.3em;}
	#pagenavi .next:before{ top: 3px;}
	#pagenavi .prev:before{ top: 3px;}
	.container .mid-col .mid-col-container #content .archives .title{ font-size: 1.5em;}
	.container .mid-col .mid-col-container #content article{ padding: 15px 0px;}
	#header .subtitle {
		line-height: 1.2em;
		padding-top: 8px;
	}
	article pre{ background: none; border: none; padding: 0;}
	article .entry-content{text-align: left;}
	.share-comment{ padding: 25px 0px; clear: both;}
	hr{ margin: 20px 0px;border: 0; border-top:solid 1px #ddd;}
	</style>
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner">
				 
				 	<div class="profilepic">
						<img src="/asset/img/logo.png" style="width:160px;">
					</div>
            	
					
					<h1><a href="index.html">黑猫也紧张</a></h1>
					<p class="subtitle"></p>
					<nav id="main-nav">
						<ul class="main">
						
						  <li id=""><a target="_self" href="index.html">Home</a></li>
						
						  <li id=""><a target="_self" href="archives.html">Archives</a></li>
						
						</ul>
					</nav>

					<nav id="sub-nav">
						<div class="social">








<a target="_blank" class="weibo" href="https://weibo.com/nervousCat" title="weibo">Weibo</a>

<a target="_blank" class="github" target="_blank" href="https://github.com/maweefeng" title="GitHub">GitHub</a>
<a target="_blank" class="email" href="mailto:maweefeng@gmail.com" title="Email">Email</a>

								

								<a class="rss" href="atom.xml" title="RSS">RSS</a>
							
						</div>
					</nav>
				</header>				
			</div>
		</div>	
		<div class="mid-col">
			<div class="mid-col-container"> <div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">


	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2018-11-21T14:57:29+08:00" itemprop="datePublished">2018/11/21</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='iOS%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html'>iOS开发技巧</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15427834493345.html" itemprop="url">
		高效的画线</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>先创建一个UIBeizerPath 的对象path</p>

<pre><code>UIBezierPath *path = [[UIBezierPath alloc] init];
  [path moveToPoint:CGPointMake(175, 100)];
  
  [path addArcWithCenter:CGPointMake(150, 100) radius:25 startAngle:0 endAngle:2*M_PI clockwise:YES];
  [path moveToPoint:CGPointMake(150, 125)];
  [path addLineToPoint:CGPointMake(150, 175)];
  [path addLineToPoint:CGPointMake(125, 225)];
  [path moveToPoint:CGPointMake(150, 175)];
  [path addLineToPoint:CGPointMake(175, 225)];
  [path moveToPoint:CGPointMake(100, 150)];
  [path addLineToPoint:CGPointMake(200, 150)];
</code></pre>

<p>然后创建CAShapeLayer添加到视图的layer上 </p>

<pre><code>CAShapeLayer *shapeLayer = [CAShapeLayer layer];
  shapeLayer.strokeColor = [UIColor redColor].CGColor;
  shapeLayer.fillColor = [UIColor clearColor].CGColor;
  shapeLayer.lineWidth = 5;
  shapeLayer.lineJoin = kCALineJoinRound;
  shapeLayer.lineCap = kCALineCapRound;
  shapeLayer.path = path.CGPath;
  //add it to our view
  [self.containerView.layer addSublayer:shapeLayer];
</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2018-11-21T14:57:29+08:00" itemprop="datePublished">2018/11/21</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='iOS%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html'>iOS开发技巧</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15427834493281.html" itemprop="url">
		为什么NSString使用Copy修饰符</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>NSString为什么要用copy关键字，用strong会有什么问题？<br/>
我们大部分的时候NSString的属性都是copy，那copy与strong的情况下到底有什么区别呢?我们以实例来说明：</p>

<pre><code class="language-@interface">@property(nonatomic,copy)NSString * str1;
@property(nonatomic,strong)NSString*str2;
@end
然后写一个测试方法：
-(void)test
{
    NSMutableString*str=[NSMutableString stringWithFormat:@&quot;helloworld&quot;];
    self.str1=str;
    self.str2=str;
    NSLog(@&quot;str:%p--%p&quot;,str,&amp;str);
    NSLog(@&quot;copy_str:%p--%p&quot;,_str1,&amp;_str1);
    NSLog(@&quot;strong_str:%p--%p&quot;,_str2,&amp;_str2);
}
</code></pre>

<p>最后我们运行看打印结果：</p>

<pre><code class="language-2017-06-15">2017-06-15 15:21:55.910 oa[1236:78490] copy_str:0x600000026e60--0x7fc66cc06358
2017-06-15 15:21:55.911 oa[1236:78490] strong_str:0x600000075cc0--0x7fc66cc06360
</code></pre>

<p>从打印结果上我们可以看出str和_str2的对象地址是一样的，指向同一个对象，所以它们的值也是一样的，而str和_str1对象地址不同，是两个不同的对象，所以copy是深复制，创建了一个新的对象。 <br/>
现在改变str的值，看看str1和str2有什么变化：</p>

<pre><code class="language-[str">    NSLog(@&quot;****************%@&quot;,self.str1);
    NSLog(@&quot;****************%@&quot;,self.str2);
</code></pre>

<p>打印结果如下：</p>

<pre><code class="language-2017-06-15">2017-06-15 15:21:55.911 oa[1236:78490] ****************helloworldhry
</code></pre>

<p>从打印结果可以看出经过copy关键字修饰过的str1并没有因为str的变化而变化，经过strong修饰过的str2却随str的改变而改变。 <br/>
所以，如果一般情况下，我们都不希望字串的值跟着str变化，所以我们一般用copy来设置string的属性。 <br/>
如果希望字串的值跟着赋值的字串的值变化，可以使用strong。<br/>
注意：上面的情况是针对于当把NSMutableString赋值给NSString的时候，才会有不同，如果是赋值是NSString对象，那么使用copy还是strong，结果都是一样的，因为NSString对象根本就不能改自身的值，他是不可变的。<br/>
把一个对象赋值给一个属性变量，当这个对象变化了，如果希望属性变量变化就使用strong属性，如果希望属性变量不跟着变化，就是用copy属性。<br/>
由此可以看出： <br/>
对源头是NSMutableString的字符串，strong仅仅是指针引用，增加了引用计数器，这样源头改变的时候，用这种strong方式声明的变量（无论被赋值的变量是可变的还是不可变的），它也会跟着改变;而copy声明的变量，它不会跟着源头改变，它实际上是深拷贝。<br/>
对源头是NSString的字符串，无论是strong声明的变量还是copy声明的变量，当第二次源头的字符串重新指向其它的地方的时候，它还是指向原来的最初的那个位置，也就是说其实二者都是指针引用，也就是浅拷贝。<br/>
另外说明一下，这两者对内存计数的影响都是一样的，都会增加内存引用计数，都需要在最后的时候做处理。<br/>
其实说白了，对字符串为啥要用这两种方式？我觉得还是一个安全问题，比如声明的一个NSString *mStr变量，然后把一个NSMutableString *str变量的赋值给它了，如果要求mStr跟着str变化，那么就用strong;如果mStr不能跟着str一起变化，那就用copy。而对于要把NSString类型的字符串赋值给mStr，那两都没啥区别。不会影响安全性，内存管理也一样。</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2018-11-21T14:57:29+08:00" itemprop="datePublished">2018/11/21</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='iOS%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html'>iOS开发技巧</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15427834493214.html" itemprop="url">
		iOS开发一些小技巧</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<pre><code>去掉xcode黄色警告的方法
#pragma clang diagnostic push
#pragma clang diagnostic ignored &quot;-Wdeprecated-declarations&quot;
 your code with warning
#pragma clang diagnostic pop

#pragma clang diagnostic push
#pragma clang diagnostic ignored &quot;-Wunused-variable&quot;
 your code with warning
#pragma clang diagnostic pop
</code></pre>

<pre><code>_coverView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, SCREENWIDTH, SCREENHEIGHT)];
在控制器init方法中初始化一个大小为self.view.bounds的uiview必须等待视图出来的时候才会进行 
要不然一直在主线程等待
如果直接给CGRectmake设置的话不用等界面加载就会执行
应该是一个主线程问题 
这个时候如果直接去xib里面的控件，就会出现取不到的情况，取出来是nil
</code></pre>

<pre><code>今天遇到个问题，后台用java写的，给我传回一个空字符串，类型是NSNull，用
stringWithFormat:转出来居然是@&quot;&lt;null&gt;&quot;，
注意，这不是空，NSNull和nil是不同的。需要用 xxx == [NSNull null]加以判断。
</code></pre>

<pre><code>去掉UITableView多余的空白行分割线
有一种简单的方法
self.tableView.tableFooterView = [[UIView alloc] initWithFrame:CGRectZero];


</code></pre>

<hr/>

<pre><code> 如何将本地代码提交到远程git仓库
* 第一步：建立git仓库 
cd到你的本地项目根目录下，执行git命令 
 git init
* 第二步：将项目的所有文件添加到仓库中   
 git add .  
* 第三步：将add的文件commit到仓库
  git commit -m &quot;注释语句&quot;
* 第四步：去github上创建自己的Repository
* 第五步：重点来了，将本地的仓库关联到github上    
  git remote add origin 仓库url
 后面的https链接地址换成你自己的仓库url地址，也就是上面红框中标出来的地址
* 第六步：上传github之前，要先pull一下，执行如下命令：
  git pull origin master
* 第七步，也就是最后一步，上传代码到github远程仓库
  git push -u origin master  
  git push -u origin master -f //强制push
  每次如果有代码需要提交必须要add一下 并且在本地commit 打下log 再去拉取remote代码，
  然后push到remote的这样一个流程。
</code></pre>

<h3 id="toc_0">button 的文字显示不全</h3>

<pre><code> [label setAdjustsFontForContentSizeCategory:YES]调节字体大小.
</code></pre>

<h3 id="toc_1">从xib加载View</h3>

<pre><code>// Instantiate the nib content without any reference to it.
NSArray *nibContents = [[NSBundle mainBundle] loadNibNamed:@&quot;EPPZPlainView&quot; owner:nil options:nil];
  
// Find the view among nib contents (not too hard assuming there is only one view in it).
UIView *plainView = [nibContents lastObject];
  
// Some hardcoded layout.
CGSize padding = (CGSize){ 22.0, 22.0 };
plainView.frame = (CGRect){padding.width, padding.height, plainView.frame.size};
  
// Add to the view hierarchy (thus retain).
[self.view addSubview:plainView];
</code></pre>

<h3 id="toc_2">修改导航条的颜色</h3>

<p><code>self.navigationController.navigationBar.barTintColor = [UIColor redColor];</code></p>

<h3 id="toc_3">当某个UIView调用drawRect方法之后，它的默认背景就是黑色的</h3>

<ul>
<li>解决办法有在初始化的时候设置backgroundColor<br/></li>
</ul>

<pre><code>- (void)awakeFromNib {
    [super awakeFromNib];
    self.backgroundColor = [UIColor clearColor];
    // Initialization code
}
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        self.backgroundColor = [UIColor blueColor]
    }
    return self;
}
</code></pre>

<ul>
<li>或者在drawRect里面写下如下代码 </li>
</ul>

<pre><code>- (void)drawRect:(CGRect)rect
{
    // Drawing code
    [[UIColor blueColor] setFill];  // changes are here
    UIRectFill(rect);               // and here 
}
</code></pre>

<h3 id="toc_4">主线程死锁</h3>

<pre><code>    NSLog(@&quot;1---%@&quot;,[NSThread currentThread]);
    dispatch_sync(dispatch_get_main_queue(), ^{
        NSLog(@&quot;2&quot;);
    });
    NSLog(@&quot;3&quot;);
    
    NSLog(@&quot;1---%@&quot;,[NSThread currentThread]);
    dispatch_async(dispatch_get_main_queue(), ^{
        NSLog(@&quot;2&quot;);
    });
    NSLog(@&quot;3&quot;);
    //打印顺序 1，3，2
    
    先加入的通知先收到通知
    先去执行通知的内容
    
</code></pre>

<h3 id="toc_5">解决tableviewsection悬浮的问题</h3>

<pre><code>   
   - (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    CGFloat sectionHeaderHeight = 50;
    if (scrollView.contentOffset.y&lt;=sectionHeaderHeight&amp;&amp;scrollView.contentOffset.y&gt;=0) {
        scrollView.contentInset = UIEdgeInsetsMake(-scrollView.contentOffset.y, 0, 0, 0);
    } else if (scrollView.contentOffset.y&gt;=sectionHeaderHeight) {
        scrollView.contentInset = UIEdgeInsetsMake(-sectionHeaderHeight, 0, 0, 0);
    }
}

</code></pre>

<h3 id="toc_6">NSURLSession请求</h3>

<pre><code> NSURLSession * session = [NSURLSession sharedSession];
    NSURLSessionDataTask * task = [session dataTaskWithRequest:request completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) {
        NSDictionary * dic = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableLeaves error:nil];
        
        NSLog(@&quot;%@&quot;,dic);
        
    }];
    [task resume];
</code></pre>

<h3 id="toc_7">实现点击按钮出发一次震动，比如“即刻”app的点赞</h3>

<pre><code>导入AudioToolBox.framework
在按钮的点击方法中执行
AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);//上面是震动方法 不灵巧


可以使用最新的
 UIImpactFeedbackGenerator  * zhend = [[UIImpactFeedbackGenerator alloc]initWithStyle:UIImpactFeedbackStyleLight];
        [zhend impactOccurred];




</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2018-11-21T14:57:29+08:00" itemprop="datePublished">2018/11/21</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='iOS%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html'>iOS开发技巧</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15427834493029.html" itemprop="url">
		ios导航条背景颜色</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<h4 id="toc_0">Situation one</h4>

<p><code>self.navigationBar.barTintColor= [UIColor redColor];</code><br/>
这时候的效果就是纯色的<br/>
类似下面这样<br/>
<img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fsbvzqlgesj309f01oglk.jpg" alt=""/></p>

<h4 id="toc_1">Situation two</h4>

<p><code>self.navigationBar.backgroundColor = [UIColor redColor];</code><br/>
<img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fsbvypka0rj309e01p0so.jpg" alt=""/></p>

<p>一种是有渐变的半透明效果，一种就是简单的纯色效果。</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2018-11-21T14:57:29+08:00" itemprop="datePublished">2018/11/21</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='iOS%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html'>iOS开发技巧</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="15427834492830.html" itemprop="url">
		CAMediaTimingFunction获取控制点：</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>//create timing function<br/>
CAMediaTimingFunction *function = [CAMediaTimingFunction functionWithControlPoints:1 :0 :0.75 :1];</p>

<p>我得到的controlPoint值似乎是错误的：</p>

<p>CGPoint controlPoint1, controlPoint2;<br/>
[function getControlPointAtIndex:1 values:(float *)&amp;controlPoint1]; <br/>
[function getControlPointAtIndex:2 values:(float *)&amp;controlPoint2];<br/>
The controlPoint value that I get seems to be wrong:</p>

<p>controlPoint1   CGPoint (x = 5.2635442471208903E-315, y = 4.9406564584124654E-324)<br/><br/>
controlPoint2   CGPoint (x = 0.0078125018408172764, y = 2.8421186829703262E-314)<br/><br/>
但是，如果我使用float数组作为参数的类型values，我得到controlPoint的正确值：</p>

<p>float c1p[2], c2p[2];<br/>
[function getControlPointAtIndex:1 values:c1p];<br/>
[function getControlPointAtIndex:2 values:c2p];<br/>
The values are:</p>

<p>controlPoint1   CGPoint (x = 1, y = 0)<br/><br/>
controlPoint2   CGPoint (x = 0.75, y = 1) </p>

<p>32位设备可以使用第一种方法 但是在64位设备就行不通了 </p>


			
			
		</div>

	</article>
  

</div>
<nav id="pagenavi">
	 
	 <a class="next" href="iOS开发技巧_1.html">Next</a> 
	<div class="center"><a href="archives.html">Blog Archives</a></div>

</nav>

</div>



        </div>
			<footer id="footer" class="inner">Copyright &copy; 2014
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a> &nbsp;&nbsp; 
Theme by <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
      </footer>
		</div>
	</div>

  
    
<script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

</body>
</html>