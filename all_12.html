<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
  
  
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site: ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="_self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="https://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; </span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="_self" href="index.html">Home</a></li>
        
        <li><a target="_self" href="archives.html">Archives</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="%E7%94%B5%E5%BD%B1.html">ç”µå½±</a></li>
        
            <li><a href="%E5%85%B6%E5%AE%83.html">å…¶å®ƒ</a></li>
        
            <li><a href="Python.html">Python</a></li>
        
            <li><a href="iOS.html">iOS</a></li>
        
            <li><a href="%E6%88%91.html">æˆ‘</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
	$(function(){
		$('#menu_item_index').addClass('is_active');
	});
</script>
<div class="row">
	<div class="large-8 medium-8 columns">
		<div class="markdown-body home-categories">
		
			<div class="article">
                <a class="clearlink" href="16076509808799.html">
                
                  <h1>python3 urllib è®¿é—®httpsç½‘ç«™</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>ssl._create_default_https_context=ssl._create_unverified_context<br/>
urllib  urllib2 urllib3å¹¶ä¸æ˜¯è¿›åŒ–å…³ç³»<br/>
urllibå’Œurllib2æ˜¯ç›¸äº’ç‹¬ç«‹çš„æ¨¡ç‰ˆ</p>

<h2 id="toc_0">åˆ—è¡¨</h2>

<ul>
<li>åˆ—è¡¨æ·»åŠ æ–°å…ƒç´ <br/>
append()</li>
<li><p>åˆ—è¡¨åˆ é™¤å…ƒç´ </p>
<blockquote>
<p>pop()æ–¹æ³•æ€»æ˜¯åˆ æ‰listçš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”å®ƒè¿˜è¿”å›è¿™ä¸ªå…ƒç´ </p>
</blockquote>
<p>pop()</p>
<p>pop(2)åˆ æ‰listä¸­ç´¢å¼•ä¸º2çš„å…ƒç´ </p></li>
</ul>

<h2 id="toc_1">å…ƒç»„</h2>

<p>å…ƒç»„å’Œåˆ—è¡¨ä¸åŒçš„æ˜¯åˆ›å»ºæ–¹å¼ç”¨()æ›¿ä»£äº†[]ï¼Œè€Œä¸”å…ƒç»„ä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½æ”¹å˜ã€‚</p>

<p>åŒæ ·å¯ä»¥æ ¹æ®ç´¢å¼•å–åˆ°å…ƒç»„çš„å†…å®¹ã€‚</p>

<pre><code class="language-text">&gt;&gt;&gt; t = (1)
&gt;&gt;&gt; print t
1
</code></pre>

<p>åˆ›å»ºå•å…ƒç»„éœ€è¦æ³¨æ„ï¼Œå› ä¸ºåˆ›å»ºå…ƒç»„çš„æ–¹å¼æ˜¯ï¼ˆï¼‰å’Œè¿ç®—ä¼˜å…ˆçº§å†²çªäº†ï¼Œæ‰€ä»¥ä¸Šé¢çš„ç»“æœæ˜¯1ã€‚</p>

<p>æ‰€ä»¥åˆ›å»ºå•å…ƒç»„è¦åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ åè‡ªåŠ¨æ·»åŠ ä¸€ä¸ª&#39;,&#39;ï¼Œå°±åƒä¸‹é¢çš„ä¸€æ ·ã€‚</p>

<pre><code class="language-text">&gt;&gt;&gt; t = (1,)
&gt;&gt;&gt; print t
(1,)
</code></pre>

<p>è¿˜æœ‰éœ€è¦æ³¨æ„çš„æ˜¯å…ƒç»„ä¹Ÿå¯ä»¥&#39;å¯å˜â€˜ï¼Œå…¶å®è¿™ç§å¯å˜å¹¶ä¸æ˜¯çœŸæ­£çš„å¯å˜ã€‚æ¯”å¦‚ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ï¼Œå…ƒç»„ä¸­åŒ…æ‹¬ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„å°±å¯ä»¥æ”¹å˜ã€‚</p>

<pre><code class="language-text">&gt;&gt;&gt; t = (&#39;a&#39;, &#39;b&#39;, [&#39;A&#39;, &#39;B&#39;])
&gt;&gt;&gt; L = t[2]
&gt;&gt;&gt; L[0] = &#39;X&#39;
&gt;&gt;&gt; L[1] = &#39;Y&#39;
&gt;&gt;&gt; print t
(&#39;a&#39;, &#39;b&#39;, [&#39;X&#39;, &#39;Y&#39;])
</code></pre>

<h2 id="toc_2">set</h2>

<p>Pythonä¸­ä»€ä¹ˆæ˜¯set<br/>
dictçš„ä½œç”¨æ˜¯å»ºç«‹ä¸€ç»„ key å’Œä¸€ç»„ value çš„æ˜ å°„å…³ç³»ï¼Œdictçš„keyæ˜¯ä¸èƒ½é‡å¤çš„ã€‚</p>

<p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªæƒ³è¦ dict çš„ keyï¼Œä¸å…³å¿ƒ key å¯¹åº”çš„ valueï¼Œç›®çš„å°±æ˜¯ä¿è¯è¿™ä¸ªé›†åˆçš„å…ƒç´ ä¸ä¼šé‡å¤ï¼Œè¿™æ—¶ï¼Œsetå°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p>

<p>set æŒæœ‰ä¸€ç³»åˆ—å…ƒç´ ï¼Œè¿™ä¸€ç‚¹å’Œ list å¾ˆåƒï¼Œä½†æ˜¯setçš„å…ƒç´ æ²¡æœ‰é‡å¤ï¼Œè€Œä¸”æ˜¯æ— åºçš„ï¼Œè¿™ç‚¹å’Œ dict çš„ keyå¾ˆåƒã€‚</p>

<p>åˆ›å»º set çš„æ–¹å¼æ˜¯è°ƒç”¨ set() å¹¶ä¼ å…¥ä¸€ä¸ª listï¼Œlistçš„å…ƒç´ å°†ä½œä¸ºsetçš„å…ƒç´ ï¼š</p>

<pre><code class="language-text">&gt;&gt;&gt; s = set([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;])
&gt;&gt;&gt; print s
set([&#39;A&#39;, &#39;C&#39;, &#39;B&#39;])
</code></pre>

<h3 id="toc_3">Pythonä¹‹ è®¿é—®set</h3>

<p>ç”±äºsetå­˜å‚¨çš„æ˜¯æ— åºé›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æ³•é€šè¿‡ç´¢å¼•æ¥è®¿é—®ã€‚</p>

<p>è®¿é—® setä¸­çš„æŸä¸ªå…ƒç´ å®é™…ä¸Šå°±æ˜¯åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨setä¸­ã€‚</p>

<p>ä¾‹å¦‚ï¼Œå­˜å‚¨äº†ç­é‡ŒåŒå­¦åå­—çš„setï¼š</p>

<p><code>&gt;&gt;&gt; s = set([&#39;Adam&#39;, &#39;Lisa&#39;, &#39;Bart&#39;, &#39;Paul&#39;])<br/>
</code><br/>
æˆ‘ä»¬å¯ä»¥ç”¨ in æ“ä½œç¬¦åˆ¤æ–­ï¼š</p>

<p>Bartæ˜¯è¯¥ç­çš„åŒå­¦å—ï¼Ÿ</p>

<pre><code class="language-text">&gt;&gt;&gt; &#39;Bart&#39; in s
True

</code></pre>

<h3 id="toc_4">Pythonä¹‹ éå†set</h3>

<p>ç”±äº set ä¹Ÿæ˜¯ä¸€ä¸ªé›†åˆï¼Œæ‰€ä»¥ï¼Œéå† set å’Œéå† list ç±»ä¼¼ï¼Œéƒ½å¯ä»¥é€šè¿‡ for å¾ªç¯å®ç°ã€‚</p>

<p>ç›´æ¥ä½¿ç”¨ for å¾ªç¯å¯ä»¥éå† set çš„å…ƒç´ ï¼š</p>

<pre><code class="language-text">&gt;&gt;&gt; s = set([&#39;Adam&#39;, &#39;Lisa&#39;, &#39;Bart&#39;])
&gt;&gt;&gt; for name in s:
...     print name
... 
Lisa
Adam
Bart
</code></pre>

<h3 id="toc_5">Pythonä¹‹ æ›´æ–°set</h3>

<p>add()æ·»åŠ <br/>
remove()åˆ é™¤</p>

<h3 id="toc_6">Pythonä¹‹ unicodeç¼–ç </h3>

<pre><code class="language-text">åœ¨å­—ç¬¦ä¸²å‰é¢åŠ ä¸Šu æ¯”å¦‚
&gt;&gt;&gt;a = u&quot;123&quot;
&gt;&gt;&gt;type(a)
&gt;&gt;&gt;unicode

&gt;&gt;&gt;b = &quot;123&quot;
&gt;&gt;&gt;type(b)
&gt;&gt;&gt;str
</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2020/12/11</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Python.html'>Python</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="16076509808836.html">
                
                  <h1>Scrapy æŠ“å–ç½‘é¡µæ•°æ®</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2 id="toc_0">Scrapy ä»‹ç»</h2>

<p>Scrapyï¼ŒPythonå¼€å‘çš„ä¸€ä¸ªå¿«é€Ÿã€é«˜å±‚æ¬¡çš„å±å¹•æŠ“å–å’ŒwebæŠ“å–æ¡†æ¶ï¼Œç”¨äºæŠ“å–webç«™ç‚¹å¹¶ä»é¡µé¢ä¸­æå–ç»“æ„åŒ–çš„æ•°æ®ã€‚Scrapyç”¨é€”å¹¿æ³›ï¼Œå¯ä»¥ç”¨äºæ•°æ®æŒ–æ˜ã€ç›‘æµ‹å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚<br/>
Scrapyå¸å¼•äººçš„åœ°æ–¹åœ¨äºå®ƒæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥æ ¹æ®éœ€æ±‚æ–¹ä¾¿çš„ä¿®æ”¹ã€‚å®ƒä¹Ÿæä¾›äº†å¤šç§ç±»å‹çˆ¬è™«çš„åŸºç±»ï¼Œå¦‚BaseSpiderã€sitemapçˆ¬è™«ç­‰ï¼Œæœ€æ–°ç‰ˆæœ¬åˆæä¾›äº†web2.0çˆ¬è™«çš„æ”¯æŒã€‚<br/>
Scrapï¼Œæ˜¯ç¢ç‰‡çš„æ„æ€ï¼Œè¿™ä¸ªPythonçš„çˆ¬è™«æ¡†æ¶å«Scrapyã€‚</p>

<p>é¦–å…ˆå¿…é¡»æœ‰pythonçš„ç¯å¢ƒï¼Œå¦‚æœæ²¡æœ‰çš„è¯éœ€è¦å®‰è£…ï¼Œç›®å‰python2.xå·²ç»ä¸å†æ›´æ–°ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯python3çš„ç¯å¢ƒã€‚</p>

<p>å¦‚æœä½ å·²ç»æœ‰äº†python3çš„ç¯å¢ƒå¹¶ä¸”å·²ç»å®‰è£…äº†pip3ï¼Œé‚£ä¹ˆå®‰è£…scrapyåªéœ€è¦ä¸€è¡Œå‘½ä»¤å³å¯ã€‚</p>

<pre><code class="language-text">pip3 install scrapy
</code></pre>

<p>å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…pip3çš„è¯ï¼Œå»ºè®®å…ˆå®‰è£…pip3è¿›è¡ŒåŒ…ç®¡ç†ã€‚</p>

<h2 id="toc_1">pip3</h2>

<p>pip æ˜¯ Python åŒ…ç®¡ç†å·¥å…·ï¼Œè¯¥å·¥å…·æä¾›äº†å¯¹Python åŒ…çš„æŸ¥æ‰¾ã€ä¸‹è½½ã€å®‰è£…ã€å¸è½½çš„åŠŸèƒ½ã€‚<br/>
Python 2.7.9 + æˆ– Python 3.4+ ä»¥ä¸Šç‰ˆæœ¬éƒ½è‡ªå¸¦ pip å·¥å…·ã€‚<br/>
ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥åˆ¤æ–­æ˜¯å¦å·²å®‰è£…ï¼š</p>

<pre><code class="language-text">pip --version
</code></pre>

<p>å¦‚æœä½ è¿˜æœªå®‰è£…ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å®‰è£…ï¼š</p>

<pre><code class="language-text">$ curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py   # ä¸‹è½½å®‰è£…è„šæœ¬
$ sudo python get-pip.py    # è¿è¡Œå®‰è£…è„šæœ¬
</code></pre>

<p>æ³¨æ„ï¼šç”¨å“ªä¸ªç‰ˆæœ¬çš„ Python è¿è¡Œå®‰è£…è„šæœ¬ï¼Œpip å°±è¢«å…³è”åˆ°å“ªä¸ªç‰ˆæœ¬ï¼Œå¦‚æœæ˜¯ Python3 åˆ™æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>

<pre><code class="language-text">$ sudo python3 get-pip.py    # è¿è¡Œå®‰è£…è„šæœ¬ã€‚
</code></pre>

<p>ä¸€èˆ¬æƒ…å†µ pip å¯¹åº”çš„æ˜¯ Python 2.7ï¼Œpip3 å¯¹åº”çš„æ˜¯ Python 3.xã€‚</p>

<pre><code class="language-text">&gt;&gt;&gt;pip3  -h#æŸ¥çœ‹pip3çš„å‘½ä»¤
Commands:
  install                     Install packages.
  download                    Download packages.
  uninstall                   Uninstall packages.
  freeze                      Output installed packages in requirements format.
  list                        List installed packages.
  show                        Show information about installed packages.
  check                       Verify installed packages have compatible dependencies.
  config                      Manage local and global configuration.
  search                      Search PyPI for packages.
  wheel                       Build wheels from your requirements.
  hash                        Compute hashes of package archives.
  completion                  A helper command used for command completion.
  help                        Show help for commands.
</code></pre>

<p>æ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯installï¼Œlistï¼Œä¸€ä¸ªæ˜¯å®‰è£…æŸä¸ªæ¡†æ¶ï¼Œå¦ä¸€ä¸ªæ˜¯åˆ—å‡ºæ‰€æœ‰å®‰è£…çš„pythonæ¡†æ¶ã€‚</p>

<h2 id="toc_2">demo æŠ“å–è±†ç“£å‰250åçš„ç”µå½±</h2>

<h3 id="toc_3">æ–°å»ºscrapyé¡¹ç›®</h3>

<ol>
<li>scrapy startproject é¡¹ç›®åç§°</li>
<li>cd è¿›å…¥åˆ°é¡¹ç›®åç§° </li>
<li>cd è¿›å…¥åˆ° spiders</li>
<li>scrapy genspider xxx_spider åŸŸå #ç”Ÿæˆçˆ¬è™«ç±»
<ul>
<li>æ¯”å¦‚scrapy genspider douban_spider movie.douban.com</li>
</ul></li>
</ol>

<p>é¡¹ç›®ç›®å½•å¦‚ä¸‹</p>

<ul>
<li>douban
<ul>
<li>spiders
<ul>
<li>douban_spider.py #æœ€é‡è¦çš„çˆ¬è™«ç±»</li>
</ul></li>
<li>items.py #çˆ¬å–çš„modelç±»</li>
<li>middlewares.py #ä¸­é—´ä»¶ ä¼ªè£…useragentæˆ–è€…è®¾ç½®ä»£ç†</li>
<li>pipelines.py #ç®¡é“ç±» æ•°æ®åŒæ­¥ </li>
<li>settings.py #è®¾ç½®ç±» é‡Œé¢æœ‰ä¸€äº›é¡¹ç›®çš„é…ç½®</li>
</ul></li>
</ul>

<h3 id="toc_4">è¿è¡Œé¡¹ç›®</h3>

<p>æœ‰ä¸¤ç§æ–¹æ³•</p>

<ol>
<li>æ‰“å¼€å‘½ä»¤è¡Œå·¥å…· <code>scrapy crawl xxx_spider</code></li>
<li><p>å»ºè®®ä½¿ç”¨scrapyçš„cmdlineå·¥å…·</p>
<ul>
<li><p>åœ¨spidersæ–‡ä»¶å¤¹ä¸‹æ–°å»ºå…¥å£main.py </p>
<pre><code class="language-text">from scrapy import cmdline
cmdline.execute(&#39;scrapy crawl baidubaike_spider&#39;.split())
</code></pre>
<p>æ¯æ¬¡ä»è¿™é‡Œé¢è¿è¡Œ.pyå°±è¡Œäº†,ä¸éœ€è¦æ¯æ¬¡éƒ½è¿›åˆ°ç‰¹å®šç›®å½•è¿è¡Œtermianlç»ˆç«¯ç¨‹åºã€‚</p></li>
</ul></li>
</ol>

<h3 id="toc_5">ä¸»è¦çˆ¬è™«ç±»</h3>

<p>douban_spider.py </p>

<pre><code class="language-text"># -*- coding: utf-8 -*-
import scrapy

class DoubanSpiderSpider(scrapy.Spider):
    name = &#39;douban_spider&#39;#çˆ¬è™«å
    allowed_domains = [&#39;movie.douban.com&#39;]
    start_urls = [&#39;https://movie.douban.com/top250&#39;]#å…¥å£url æ‰”åˆ°è°ƒåº¦å™¨é‡Œé¢
    #é»˜è®¤çš„è§£ææ–¹æ³•
    def parse(self, response):
    #responseå°±æ˜¯ç½‘ç»œè¯·æ±‚ä¹‹åçš„å“åº”æ•°æ®
    #ä¸»è¦çš„ä»£ç è§£æéƒ½åœ¨è¿™ä¸ªç±»ä¸­è¿›è¡Œ
       pass

</code></pre>

<h3 id="toc_6">HTMLè§£æå™¨</h3>

<p>çˆ¬å–ä¹‹åçš„æ•°æ®å¦‚æœä¸ºhtmlå°±éœ€è¦ç”¨åˆ°htmlè§£æå™¨ï¼Œä¸šç•Œä¸€èˆ¬æœ‰ä¸‰ç§æ–¹å¼è¿›è¡Œè§£æ</p>

<ul>
<li>Beautiifulsoup</li>
<li>æ­£åˆ™åŒ¹é…å¼</li>
<li>lxmlä¸­çš„xpath </li>
</ul>

<p>æœ‰äººåšè¿‡ä¸‰ä¸ªæ–¹æ³•çš„æ¯”è¾ƒï¼Œå¤§è‡´ç»“æœå¦‚ä¸‹</p>

<table>
<thead>
<tr>
<th></th>
<th>lxml</th>
<th>beautifulsoup</th>
<th>re</th>
</tr>
</thead>

<tbody>
<tr>
<td>è¯­æ³•éš¾æ˜“åº¦</td>
<td>ç®€å•</td>
<td>ç®€å•</td>
<td>å¤æ‚</td>
</tr>
<tr>
<td>æŸ¥æ‰¾é€Ÿåº¦</td>
<td>è¾ƒå¿«</td>
<td>æ…¢</td>
<td>æœ€å¿«</td>
</tr>
</tbody>
</table>

<p>æ‰€ä»¥è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯lxmlçš„æ–¹å¼è¿›è¡Œhtmlè§£æï¼Œä¹Ÿæ¨èæ–°æ‰‹ä»è¿™ä¸ªæ–¹å¼å¼€å§‹å…¥é—¨ã€‚</p>

<h4 id="toc_7">lxml</h4>

<p>lxmlæ˜¯é€šè¿‡xpathæ¥æŸ¥æ‰¾ï¼Œä½¿ç”¨å‰éœ€ä½¿ç”¨è°ƒç”¨ertee.HTML()æ–¹æ³•(&#39;()&#39;å†…å¡«HTMLä»£ç )ç”Ÿæˆä¸€ä¸ªå¯æŸ¥æ‰¾çš„å¯¹è±¡ã€‚</p>

<h5 id="toc_8">å¸¸ç”¨xpathè¯­æ³•å¦‚ä¸‹</h5>

<pre><code class="language-text">// ä¸¤ä¸ªæ–œæ ä¸ºå‘ä¸‹æŸ¥æ‰¾å­™å­æ ‡ç­¾
    
/ ä¸€ä¸ªæ–œæ ä¸ºæŸ¥æ‰¾ç›´æ¥å„¿å­æ ‡ç­¾
    
[] æ–¹æ‹¬å·å†…å¡«æ ‡ç­¾å±æ€§,å¦‚æŸ¥æ‰¾classå±æ€§ä¸ºnameçš„aæ ‡ç­¾,æ ¼å¼ä¸ºa[@class=&quot;name&quot;]
    
/text() å–å‡ºæ ‡ç­¾çš„å†…å®¹,å¦‚æŸ¥æ‰¾ç½‘é¡µä¸­çš„ &lt;a class=&quot;name&quot;&gt;KAINHUCK&lt;/a&gt; ä¸­çš„KAINHUCK,æ ¼å¼ä¸º//a[@class=&quot;name&quot;]/text()
    
/@attr å–å‡ºæ ‡ç­¾çš„å±æ€§,å¦‚æŸ¥æ‰¾ç½‘é¡µä¸­çš„ &lt;a class=&quot;name&quot;&gt;KAINHUCK&lt;/a&gt; ä¸­çš„classå±æ€§å€¼name,æ ¼å¼ä¸º//a[@class=&quot;name&quot;]/@class 

</code></pre>

<h5 id="toc_9">xpath å¦‚ä½•æå–å‡ºdivä¸‹é¢æ‰€æœ‰æ ‡ç­¾çš„æ–‡æœ¬å†…å®¹</h5>

<p>æœ‰æ—¶å€™ä¸€ä¸ªdivæ ‡ç­¾ä¸‹ä¼šæœ‰ä¸åŒçš„æ ‡ç­¾ï¼Œå¦‚æœåªæ˜¯å•çº¯çš„ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œå¹¶ä¸èƒ½æå–åˆ°divä¸‹é¢çš„æ‰€æœ‰æ–‡æœ¬å†…å®¹ï¼Œæ‰€ä»¥xpathæä¾›äº†string(.)æ–¹æ³•ã€‚</p>

<pre><code class="language-text">title = html.xpath(&#39;//dd[@class=&quot;lemmaWgt-lemmaTitle-title&quot;]/h1/text()&#39;)[0]

summary = html.xpath(&#39;//div[@class=&quot;lemma-summary&quot;]&#39;)[0].xpath(&#39;string(.)&#39;).strip()

#stripæ–¹æ³•è¿”å›ç§»é™¤å­—ç¬¦ä¸²å¤´å°¾æŒ‡å®šçš„å­—ç¬¦ç”Ÿæˆçš„æ–°å­—ç¬¦ä¸²ã€‚    
</code></pre>

<h4 id="toc_10">åˆ†ææŠ“å–ç½‘ç«™çš„htmlæ ‡ç­¾</h4>

<p>è¿›å…¥chromeæ‰“å¼€å¼€å‘è€…è°ƒè¯•å·¥å…·</p>

<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1g3kate3mbuj30w00h3n21.jpg" alt=""/></p>

<p>å¦å¤–è¦ä½¿ç”¨lxmlçš„æ–¹å¼è¿›è¡Œè§£æï¼Œå¯ä»¥å®‰è£…æ’ä»¶è¿›è¡ŒæŸ¥æ‰¾ï¼Œåˆ°chromeçš„å•†åŸä¸‹è½½xpathï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥çœ‹åˆ°ç»“æœäº†ï¼Œä»¥é˜²æŠ“å–åˆ°çš„æ ‡ç­¾å‡ºé”™ã€‚</p>

<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1g3kavur7ggj30vt0h0q8t.jpg" alt=""/></p>

<pre><code class="language-text">//div[@class=&quot;article&quot;]//ol[@class=&quot;grid_view&quot;]/li
</code></pre>

<p>è¿™æ®µè¯­æ³•ç”¨äºæ‰¾åˆ°classä¸ºarticleçš„divæ ‡ç­¾ä¸‹çš„classä¸ºgrid_viewçš„olçš„å­å­™æ ‡ç­¾ä¸‹çš„liæ ‡ç­¾ã€‚</p>

<p>æŸ¥æ‰¾å‡ºæ¥çš„ç»“æœæ˜¯ä¸ªåŒ…å«25ä¸ªå…ƒç´ çš„list</p>

<h3 id="toc_11">ä»£ç ç¼–å†™</h3>

<p>ç„¶åè¿›å…¥åˆ°æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œå¯¼å…¥lxmlå·¥å…·ï¼Œä»¥åŠDoubanItem</p>

<pre><code class="language-text"># -*- coding: utf-8 -*-
import scrapy
from lxml import etree
from douban.items import DoubanItem


class DoubanSpiderSpider(scrapy.Spider):
    name = &#39;douban_spider&#39;#çˆ¬è™«å
    allowed_domains = [&#39;movie.douban.com&#39;]
    start_urls = [&#39;https://movie.douban.com/top250&#39;]#å…¥å£url æ‰”åˆ°è°ƒåº¦å™¨é‡Œé¢
    #é»˜è®¤çš„è§£ææ–¹æ³•
    def parse(self, response):
        #å¾ªç¯ç”µå½±çš„æ¡ç›®
        html = etree.HTML(response.text)
        movie_list = html.xpath(&#39;//div[@class=&quot;article&quot;]//ol[@class=&quot;grid_view&quot;]/li&#39;)
        for item in movie_list:
            #itemæ–‡ä»¶å¯¼å…¥
            douban_item = DoubanItem()
            #å†™è¯¦ç»†çš„xpath è¿›è¡Œæ•°æ®çš„è§£æ
            douban_item[&#39;serial_number&#39;] = item.xpath(&#39;.//div[@class=&quot;item&quot;]//em/text()&#39;)[0]
            douban_item[&#39;movie_name&#39;] = item.xpath(&#39;.//div[@class=&quot;info&quot;]//a/span[1]/text()&#39;)[0]
            content_list = item.xpath(&#39;.//div[@class=&quot;info&quot;]//div[@class=&quot;bd&quot;]/p[1]/text()&#39;)
            for content in content_list:
                content_s = &quot;&quot;.join(content.split())
                douban_item[&#39;introduce&#39;] = content_s

            douban_item[&#39;star&#39;]= item.xpath(&#39;.//div[@class=&quot;star&quot;]/span[@class=&quot;rating_num&quot;]/text()&#39;)[0]
            douban_item[&#39;comment&#39;] = item.xpath(&#39;.//div[@class=&quot;star&quot;]/span[4]/text()&#39;)[0]
            douban_item[&#39;description&#39;] = item.xpath(&#39;.//p[@class=&quot;quote&quot;]/span[1]/text()&#39;)[0]
            print(douban_item)
            yield douban_item #yeildåˆ°piplinesé‡Œé¢ è¿›è¡Œæ•°æ®æ¸…æ´— æ•°æ®å­˜å‚¨
        
        #è§£æä¸‹ä¸€é¡µè§„åˆ™ è·å–åä¸€é¡µçš„xpath
        next_link = html.xpath(&#39;//span[@class=&quot;next&quot;]/link/@href&#39;)

        if next_link:
            next_link = next_link[0]
            #yeildåˆ°è°ƒåº¦å™¨å½“ä¸­ åé¢ç»™äº†å›è°ƒå‡½æ•°
            yield scrapy.Request(&#39;https://movie.douban.com/top250&#39;+next_link,callback=self.parse)

</code></pre>

<p>å…¶ä¸­é‡è¦çš„æœ‰yieldæ–¹æ³•ï¼ŒæŠŠæˆ‘ä»¬ç”Ÿæˆçš„modelç±»ä¼ è¾“åˆ°piplinesé‡Œé¢è¿›è¡Œæ•°æ®çš„å­˜å‚¨ã€‚</p>

<p>è¿˜æœ‰å°±æ˜¯å› ä¸ºè¿™åªæ˜¯ä¸€é¡µçš„æ•°æ®ï¼Œæƒ³è¦æŠ“å–çš„250æ¡æ•°æ®ï¼Œé‚£å°±è¦è¿›è¡Œå¤šæ¬¡æŠ“å–ï¼Œè¿›è¿‡åˆ†æå‘ç°åªéœ€è¦æ¯æ¬¡æŠŠåé¡µçš„aæ ‡ç­¾çš„hrefæ‹¿åˆ°å°±å¯ä»¥äº†ï¼Œé€šè¿‡xpathè¿›è¡Œè§£æå°±æ˜¯ </p>

<pre><code class="language-text">#è§£æä¸‹ä¸€é¡µè§„åˆ™ è·å–åä¸€é¡µçš„xpath
        next_link = html.xpath(&#39;//span[@class=&quot;next&quot;]/link/@href&#39;)

</code></pre>

<p>æœ€å¥½éœ€è¦yeildåˆ°è°ƒåº¦å™¨å½“ä¸­ï¼Œå› ä¸ºæ˜¯éƒ¨åˆ†è·¯å¾„ï¼Œæ‰€ä»¥è¦å…ˆè¿›è¡Œè·¯å¾„çš„æ‹¼æ¥ï¼Œè¿˜è¦æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œå°±æ˜¯è¯·æ±‚ä¹‹åè¿›å…¥çš„å›è°ƒæ–¹æ³•ã€‚</p>

<h3 id="toc_12">æ•°æ®å¯¼å‡º</h3>

<p>åœ¨spidersæ–‡ä»¶å¤¹ä¸‹æ–°å»ºoutputdata.py </p>

<pre><code class="language-text">#æ•°æ®å¯¼å‡º ä¹Ÿå¯ä»¥ä½¿ç”¨terminal ç›´æ¥è¿è¡Œ
from scrapy import cmdline
#æ•°æ®å¯¼å‡ºåˆ°json
# cmdline.execute(&#39;scrapy crawl douban_spider -o output.json&#39;.split())

#æ•°æ®å¯¼å‡ºåˆ°csvæ ¼å¼
cmdline.execute(&#39;scrapy crawl douban_spider -o output.csv&#39;.split())
</code></pre>

<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1g3kbfcz850j30os0jf0y5.jpg" alt=""/></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2020/12/11</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Python.html'>Python</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="16076509808874.html">
                
                  <h1>xpath æå–divæ ‡ç­¾æ‰€æœ‰æ–‡å­—ä¿¡æ¯</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p><img src="media/15591149863353/15591150079270.jpg" alt=""/></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2020/12/11</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Python.html'>Python</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="16076509808917.html">
                
                  <h1></h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h1 id="toc_0">curl</h1>

<p>æŠ“å–ç½‘é¡µå†…å®¹<br/>
curl -v <a href="https://www.imooc.com/video/13082">https://www.imooc.com/video/13082</a></p>

<p>æŠŠç½‘é¡µå†…å®¹å­˜å‚¨åˆ°tmp.txt<br/>
curl -v <a href="https://www.imooc.com/video/13082">https://www.imooc.com/video/13082</a> &gt; tmp.txt</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2020/12/11</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Python.html'>Python</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="16076509809222.html">
                
                  <h1>è®°å½•swift å½“ä¸­è¶…å‡ºä»¥å‰è®¤çŸ¥çš„çŸ¥è¯†ç‚¹</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2 id="toc_0">æ”¯æŒunicodeç¼–ç çš„å˜é‡å€¼</h2>

<pre><code class="language-text">let a = [Int]()
let ğŸ¶ğŸ® = &quot;dogcow&quot;
let ä½ å¥½ = &quot;ä½ å¥½ä¸–ç•Œ&quot;
</code></pre>

<h2 id="toc_1">é”™è¯¯å¤„ç†</h2>

<p>æ‚¨ä½¿ç”¨é”™è¯¯å¤„ç†æ¥å“åº”ç¨‹åºåœ¨æ‰§è¡ŒæœŸé—´å¯èƒ½é‡åˆ°çš„é”™è¯¯æƒ…å†µã€‚</p>

<p>ä¸å¯ä»¥ä½¿ç”¨å€¼çš„å­˜åœ¨æˆ–ä¸å­˜åœ¨æ¥ä¼ é€’å‡½æ•°æˆåŠŸæˆ–å¤±è´¥çš„é€‰é¡¹ç›¸æ¯”ï¼Œé”™è¯¯å¤„ç†å…è®¸æ‚¨ç¡®å®šå¤±è´¥çš„æ ¹æœ¬åŸå› ï¼Œå¹¶åœ¨å¿…è¦æ—¶å°†é”™è¯¯ä¼ æ’­åˆ°ç¨‹åºçš„å¦ä¸€éƒ¨åˆ†ã€‚</p>

<p>å½“å‡½æ•°é‡åˆ°é”™è¯¯æ¡ä»¶æ—¶ï¼Œå®ƒä¼šæŠ›å‡ºé”™è¯¯ã€‚ç„¶åè¯¥å‡½æ•°çš„è°ƒç”¨è€…å¯ä»¥æ•è·é”™è¯¯å¹¶åšå‡ºé€‚å½“çš„å“åº”ã€‚</p>

<pre><code class="language-text">func canThrowAnError() throws {
    // this function may or may not throw an error
}
</code></pre>

<p>å‡½æ•°è¡¨ç¤ºå®ƒå¯ä»¥é€šè¿‡throwsåœ¨å…¶å£°æ˜ä¸­åŒ…å«å…³é”®å­—æ¥å¼•å‘é”™è¯¯ã€‚å½“æ‚¨è°ƒç”¨å¯ä»¥æŠ›å‡ºé”™è¯¯çš„å‡½æ•°æ—¶ï¼Œæ‚¨å¯ä»¥å°†tryå…³é”®å­—æ·»åŠ åˆ°è¡¨è¾¾å¼ä¸­ã€‚</p>

<p>Swiftä¼šè‡ªåŠ¨å°†é”™è¯¯ä¼ æ’­å‡ºå½“å‰ä½œç”¨åŸŸï¼Œç›´åˆ°å®ƒä»¬è¢«catchå­å¥å¤„ç†ã€‚</p>

<pre><code class="language-text">do {
    try canThrowAnError()
    // no error was thrown
} catch {
    // an error was thrown
}
</code></pre>

<p>ä¸€ä¸ªdoè¯­å¥åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…å«èŒƒå›´ï¼Œå…è®¸è¯¯å·®ä¼ æ’­åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªcatchæ¡æ¬¾ã€‚</p>

<p>ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨é”™è¯¯å¤„ç†æ¥å“åº”ä¸åŒé”™è¯¯æ¡ä»¶çš„ç¤ºä¾‹ï¼š</p>

<pre><code class="language-text">func makeASandwich() throws {
    // ...
}

do {
    try makeASandwich()
    eatASandwich()
} catch SandwichError.outOfCleanDishes {
    washDishes()
} catch SandwichError.missingIngredients(let ingredients) {
    buyGroceries(ingredients)
}
</code></pre>

<p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒmakeASandwich()å¦‚æœæ²¡æœ‰å¯ç”¨çš„å¹²å‡€èœè‚´æˆ–ç¼ºå°‘ä»»ä½•æˆåˆ†ï¼Œè¯¥å‡½æ•°å°†æŠ›å‡ºé”™è¯¯ã€‚å› ä¸ºmakeASandwich()å¯ä»¥æŠ›å‡ºé”™è¯¯ï¼Œå‡½æ•°è°ƒç”¨åŒ…å«åœ¨tryè¡¨è¾¾å¼ä¸­ã€‚é€šè¿‡å°†å‡½æ•°è°ƒç”¨åŒ…è£…åœ¨doè¯­å¥ä¸­ï¼ŒæŠ›å‡ºçš„ä»»ä½•é”™è¯¯éƒ½å°†ä¼ æ’­åˆ°æä¾›çš„catchå­å¥ã€‚</p>

<p>å¦‚æœæ²¡æœ‰æŠ›å‡ºé”™è¯¯ï¼ŒeatASandwich()åˆ™è°ƒç”¨è¯¥å‡½æ•°ã€‚å¦‚æœæŠ›å‡ºé”™è¯¯å¹¶ä¸”å®ƒä¸SandwichError.outOfCleanDisheså¤§å°å†™åŒ¹é…ï¼Œåˆ™å°†washDishes()è°ƒç”¨è¯¥å‡½æ•°ã€‚å¦‚æœæŠ›å‡ºé”™è¯¯å¹¶ä¸”å®ƒä¸SandwichError.missingIngredientså¤§å°å†™åŒ¹é…ï¼Œåˆ™buyGroceries(_:)è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¹¶ä½¿ç”¨æ¨¡å¼[String]æ•è·çš„å…³è”å€¼catchã€‚</p>

<p>é”™è¯¯å¤„ç†ä¸­æ›´è¯¦ç»†åœ°ä»‹ç»äº†æŠ›å‡ºï¼Œæ•è·å’Œä¼ æ’­é”™è¯¯ã€‚</p>

<h2 id="toc_2">ä¸€å…ƒå‡å·ç®—å­</h2>

<p>å¯ä»¥ä½¿ç”¨å‰ç¼€-ï¼ˆç§°ä¸ºä¸€å…ƒå‡å·è¿ç®—ç¬¦ï¼‰æ¥åˆ‡æ¢æ•°å€¼çš„ç¬¦å·ï¼š</p>

<pre><code class="language-text">let three = 3
let minusThree = -three       // minusThree equals -3
let plusThree = -minusThree   // plusThree equals 3, or &quot;minus minus three&quot;
</code></pre>

<p>ä¸€å…ƒå‡å·è¿ç®—ç¬¦ï¼ˆ-ï¼‰ç›´æ¥ä½äºå®ƒè¿è¡Œçš„å€¼ä¹‹å‰ï¼Œæ²¡æœ‰ä»»ä½•ç©ºæ ¼ã€‚</p>

<h2 id="toc_3">ä¸€å…ƒåŠ è¿ç®—ç¬¦</h2>

<p>åœ¨ä¸€å…ƒåŠ è¿ç®—ï¼ˆ+ï¼‰åªè¿”å›å…¶æ‰€æ“ä½œçš„ä»·å€¼ï¼Œæ²¡æœ‰ä»»ä½•å˜åŒ–ï¼š</p>

<pre><code class="language-text">let minusSix = -6
let alsoMinusSix = +minusSix  // alsoMinusSix equals -6
</code></pre>

<p>è™½ç„¶ä¸€å…ƒåŠ è¿ç®—ç¬¦å®é™…ä¸Šæ²¡æœ‰åšä»»ä½•äº‹æƒ…ï¼Œä½†æ˜¯å½“ä½¿ç”¨ä¸€å…ƒå‡è¿ç®—ç¬¦ä½œä¸ºè´Ÿæ•°æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥ä¸ºä»£ç æä¾›æ­£æ•°çš„å¯¹ç§°æ€§ã€‚</p>

<h2 id="toc_4">é—­åŒºåŸŸæ“ä½œå‘˜</h2>

<p>çš„å°é—­èŒƒå›´æ“ä½œç¬¦ï¼ˆa...bï¼‰é™å®šäº†ä»è¿è¡ŒèŒƒå›´aæ¥bï¼Œå¹¶ä¸”åŒ…æ‹¬è¿™äº›å€¼aå’Œbã€‚å€¼aä¸å¾—å¤§äºbã€‚</p>

<p>å½“åœ¨æ‚¨å¸Œæœ›ä½¿ç”¨æ‰€æœ‰å€¼çš„èŒƒå›´å†…è¿›è¡Œè¿­ä»£æ—¶ï¼Œé—­ç¯èŒƒå›´è¿ç®—ç¬¦éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ä½¿ç”¨for- inå¾ªç¯ï¼š</p>

<pre><code class="language-text">for index in 1...5 {
    print(&quot;\(index) times 5 is \(index * 5)&quot;)
}
// 1 times 5 is 5
// 2 times 5 is 10
// 3 times 5 is 15
// 4 times 5 is 20
// 5 times 5 is 25
</code></pre>

<p>æœ‰å…³for- inå¾ªç¯çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ§åˆ¶æµã€‚</p>

<h2 id="toc_5">åŠå¼€æ”¾å¼æ“ä½œå‘˜</h2>

<p>æ‰€è¿°åŠå¼€åŒºé—´è¿ç®—ç¬¦ï¼ˆa..&lt;bï¼‰é™å®šäº†ä»è¿è¡ŒèŒƒå›´aåˆ°bï¼Œä½†ä¸åŒ…æ‹¬bã€‚å®ƒè¢«è®¤ä¸ºæ˜¯åŠå¼€æ”¾çš„ï¼Œå› ä¸ºå®ƒåŒ…å«å®ƒçš„ç¬¬ä¸€ä¸ªå€¼ï¼Œä½†ä¸æ˜¯å®ƒçš„æœ€ç»ˆå€¼ã€‚ä¸é—­åŒºåŸŸè¿ç®—ç¬¦ä¸€æ ·ï¼Œå€¼aä¸å¾—å¤§äºbã€‚å¦‚æœå€¼aç­‰äºbï¼Œåˆ™ç»“æœèŒƒå›´å°†ä¸ºç©ºã€‚</p>

<p>å½“æ‚¨ä½¿ç”¨åŸºäºé›¶çš„åˆ—è¡¨ï¼ˆå¦‚æ•°ç»„ï¼‰æ—¶ï¼ŒåŠå¼€èŒƒå›´ç‰¹åˆ«æœ‰ç”¨ï¼Œå…¶ä¸­è®¡ç®—åˆ—è¡¨çš„é•¿åº¦ï¼ˆä½†ä¸åŒ…æ‹¬ï¼‰éå¸¸æœ‰ç”¨ï¼š</p>

<pre><code class="language-text">let names = [&quot;Anna&quot;, &quot;Alex&quot;, &quot;Brian&quot;, &quot;Jack&quot;]
let count = names.count
for i in 0..&lt;count {
    print(&quot;Person \(i + 1) is called \(names[i])&quot;)
}
// Person 1 is called Anna
// Person 2 is called Alex
// Person 3 is called Brian
// Person 4 is called Jack
</code></pre>

<p>è¯·æ³¨æ„ï¼Œè¯¥æ•°ç»„åŒ…å«å››ä¸ªé¡¹ç›®ï¼Œä½†0..&lt;countåªè®¡ç®—3ï¼ˆæ•°ç»„ä¸­æœ€åä¸€é¡¹çš„ç´¢å¼•ï¼‰ï¼Œå› ä¸ºå®ƒæ˜¯åŠå¼€æ”¾èŒƒå›´ã€‚æœ‰å…³æ•°ç»„çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ•°ç»„ã€‚</p>

<h2 id="toc_6">å•é¢èŒƒå›´</h2>

<p>é—­åŒºåŸŸè¿ç®—ç¬¦æœ‰ä¸€ä¸ªæ›¿ä»£å½¢å¼ï¼Œç”¨äºåœ¨ä¸€ä¸ªæ–¹å‘ä¸Šå°½å¯èƒ½ç»§ç»­çš„èŒƒå›´ - ä¾‹å¦‚ï¼ŒåŒ…æ‹¬ä»ç´¢å¼•2åˆ°æ•°ç»„æœ«å°¾çš„æ•°ç»„çš„æ‰€æœ‰å…ƒç´ çš„èŒƒå›´ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥çœç•¥èŒƒå›´è¿ç®—ç¬¦ä¸€ä¾§çš„å€¼ã€‚è¿™ç§èŒƒå›´ç§°ä¸ºå•ä¾§èŒƒå›´ï¼Œå› ä¸ºæ“ä½œå‘˜ä»…åœ¨ä¸€ä¾§å…·æœ‰å€¼ã€‚ä¾‹å¦‚ï¼š</p>

<pre><code class="language-text">for name in names[2...] {
    print(name)
}
// Brian
// Jack

for name in names[...2] {
    print(name)
}
// Anna
// Alex
// Brian
</code></pre>

<p>åŠå¼€æ”¾èŒƒå›´æ“ä½œç¬¦ä¹Ÿå…·æœ‰å•ä¾§å½¢å¼ï¼Œä»…ä½¿ç”¨å…¶æœ€ç»ˆå€¼ç¼–å†™ã€‚å°±åƒåœ¨ä¸¤ä¾§éƒ½åŒ…å«å€¼ä¸€æ ·ï¼Œæœ€ç»ˆå€¼ä¸æ˜¯èŒƒå›´çš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼š</p>

<pre><code class="language-text">for name in names[..&lt;2] {
    print(name)
}
// Anna
// Alex
</code></pre>

<p>å•è¾¹èŒƒå›´å¯ä»¥åœ¨å…¶ä»–ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ï¼Œè€Œä¸ä»…ä»…åœ¨ä¸‹æ ‡ä¸­ä½¿ç”¨ã€‚æ‚¨ä¸èƒ½è¿­ä»£å¿½ç•¥ç¬¬ä¸€ä¸ªå€¼çš„å•ä¾§èŒƒå›´ï¼Œå› ä¸ºä¸æ¸…æ¥šè¿­ä»£åº”è¯¥ä»å“ªé‡Œå¼€å§‹ã€‚æ‚¨å¯ä»¥è¿­ä»£å¿½ç•¥å…¶æœ€ç»ˆå€¼çš„å•ä¾§èŒƒå›´; ä½†æ˜¯ï¼Œå› ä¸ºèŒƒå›´æ— é™æœŸåœ°ç»§ç»­ï¼Œè¯·ç¡®ä¿ä¸ºå¾ªç¯æ·»åŠ æ˜¾å¼ç»“æŸæ¡ä»¶ã€‚æ‚¨è¿˜å¯ä»¥æ£€æŸ¥å•ä¾§èŒƒå›´æ˜¯å¦åŒ…å«ç‰¹å®šå€¼ï¼Œå¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤ºã€‚</p>

<pre><code class="language-text">let range = ...5
range.contains(7)   // false
range.contains(4)   // true
range.contains(-1)  // true
</code></pre>

<h3 id="toc_7">æ•°ç»„å…ƒç´ ä¸‹æ ‡å’Œå€¼çš„å¯¹åº”å…³ç³»</h3>

<p>å¦‚æœéœ€è¦æ¯ä¸ªé¡¹çš„æ•´æ•°ç´¢å¼•åŠå…¶å€¼ï¼Œè¯·ä½¿ç”¨è¯¥enumerated()æ–¹æ³•è¿­ä»£æ•°ç»„ã€‚å¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªé¡¹ï¼Œè¯¥enumerated()æ–¹æ³•è¿”å›ç”±æ•´æ•°å’Œé¡¹ç»„æˆçš„<code>å…ƒç»„</code>ã€‚æ•´æ•°ä»é›¶å¼€å§‹ï¼Œæ¯ä¸ªé¡¹ç›®åŠ 1; å¦‚æœæšä¸¾æ•´ä¸ªæ•°ç»„ï¼Œåˆ™è¿™äº›æ•´æ•°ä¸é¡¹ç›®çš„ç´¢å¼•ç›¸åŒ¹é…ã€‚æ‚¨å¯ä»¥å°†å…ƒç»„åˆ†è§£ä¸ºä¸´æ—¶å¸¸é‡æˆ–å˜é‡ï¼Œä½œä¸ºè¿­ä»£çš„ä¸€éƒ¨åˆ†ï¼š</p>

<pre><code class="language-text">for (index, value) in shoppingList.enumerated() {
    print(&quot;Item \(index + 1): \(value)&quot;)
}
</code></pre>

<h2 id="toc_8">å¸ƒå°”å€¼ç±»å‹ä¸èƒ½æ¯”è¾ƒå¤§å°ï¼Œå…ƒç¥–ä¹Ÿæ˜¯å¯ä»¥æ¯”è¾ƒå¤§å°çš„ã€‚</h2>

<h2 id="toc_9">åˆ›å»ºå’Œåˆå§‹åŒ–ç©ºé›†</h2>

<p>æ‚¨å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–ç¨‹åºè¯­æ³•åˆ›å»ºæŸä¸ªç±»å‹çš„ç©ºé›†ï¼š</p>

<pre><code class="language-text">var letters = Set&lt;Character&gt;()
</code></pre>

<p>Swifté›†çš„ç±»å‹å†™ä¸ºSet<Element>ï¼ŒElementå…è®¸é›†å­˜å‚¨çš„ç±»å‹åœ¨å“ªé‡Œã€‚ä¸æ•°ç»„ä¸åŒï¼Œé›†åˆæ²¡æœ‰ç­‰æ•ˆçš„ç®€å†™å½¢å¼</p>

<h2 id="toc_10">Setæ˜¯ä¸€ä¸ªæ— åºçš„ä¸é‡å¤å…ƒç´ çš„é›†åˆ</h2>

<p>Swiftçš„Setç±»å‹æ²¡æœ‰å®šä¹‰çš„é¡ºåºã€‚è¦ä»¥ç‰¹å®šé¡ºåºè¿­ä»£é›†åˆçš„å€¼ï¼Œè¯·ä½¿ç”¨è¯¥sorted()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†é›†åˆçš„å…ƒç´ ä½œä¸ºä½¿ç”¨&lt;è¿ç®—ç¬¦æ’åºçš„æ•°ç»„è¿”å›ã€‚</p>

<pre><code class="language-text">for genre in favoriteGenres.sorted() {
    print(&quot;\(genre)&quot;)
}
// Classical
// Hip hop
// Jazz
</code></pre>

<h2 id="toc_11">ä½¿ç”¨Array Literalåˆ›å»ºé›†åˆ</h2>

<p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨æ•°ç»„æ–‡å­—åˆå§‹åŒ–é›†åˆï¼Œä½œä¸ºå°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼å†™ä¸ºé›†åˆé›†åˆçš„ç®€å†™æ–¹å¼ã€‚</p>

<p>ä¸‹é¢çš„ç¤ºä¾‹åˆ›å»ºä¸€ä¸ªåä¸ºfavoriteGenreså­˜å‚¨Stringå€¼çš„é›†åˆï¼š</p>

<pre><code class="language-text">var favoriteGenres: Set&lt;String&gt; = [&quot;Rock&quot;, &quot;Classical&quot;, &quot;Hip hop&quot;]
// favoriteGenres has been initialized with three initial items
</code></pre>

<h2 id="toc_12">SetåŸºæœ¬é›†åˆè¿ç®—</h2>

<p><img src="https://docs.swift.org/swift-book/_images/setVennDiagram_2x.png" alt=""/></p>

<ul>
<li>ä½¿ç”¨è¯¥intersection(_:)æ–¹æ³•åˆ›å»ºä¸€ä¸ªä»…åŒ…å«ä¸¤ä¸ªé›†åˆå…±æœ‰å€¼çš„æ–°é›†åˆã€‚</li>
<li>ä½¿ç”¨è¯¥symmetricDifference(_:)æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°é›†åˆï¼Œå…¶ä¸­åŒ…å«ä»»ä¸€é›†åˆä¸­çš„å€¼ï¼Œä½†ä¸èƒ½åŒæ—¶åˆ›å»ºä¸¤è€…ã€‚</li>
<li>ä½¿ç”¨è¯¥union(_:)æ–¹æ³•åˆ›å»ºåŒ…å«ä¸¤ä¸ªé›†ä¸­æ‰€æœ‰å€¼çš„æ–°é›†ã€‚</li>
<li>ä½¿ç”¨æ­¤subtracting(_:)æ–¹æ³•åˆ›å»ºä¸€ä¸ªå€¼ä¸åœ¨æŒ‡å®šé›†ä¸­çš„æ–°é›†ã€‚</li>
</ul>

<pre><code class="language-text">let oddDigits: Set = [1, 3, 5, 7, 9]
let evenDigits: Set = [0, 2, 4, 6, 8]
let singleDigitPrimeNumbers: Set = [2, 3, 5, 7]

oddDigits.union(evenDigits).sorted()
// [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
oddDigits.intersection(evenDigits).sorted()
// []
oddDigits.subtracting(singleDigitPrimeNumbers).sorted()
// [1, 9]
oddDigits.symmetricDifference(singleDigitPrimeNumbers).sorted()
// [1, 2, 9]
</code></pre>

<ul>
<li>ä½¿ç”¨â€œis equalâ€è¿ç®—ç¬¦ï¼ˆ==ï¼‰æ¥ç¡®å®šä¸¤ä¸ªé›†åˆæ˜¯å¦åŒ…å«æ‰€æœ‰ç›¸åŒçš„å€¼ã€‚</li>
<li>ä½¿ç”¨æ­¤isSubset(of:)æ–¹æ³•ç¡®å®šé›†åˆçš„æ‰€æœ‰å€¼æ˜¯å¦éƒ½åŒ…å«åœ¨æŒ‡å®šçš„é›†åˆä¸­ã€‚</li>
<li>ä½¿ç”¨æ­¤isSuperset(of:)æ–¹æ³•ç¡®å®šé›†åˆæ˜¯å¦åŒ…å«æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å€¼ã€‚</li>
<li>ä½¿ç”¨isStrictSubset(of:)æˆ–isStrictSuperset(of:)æ–¹æ³•ç¡®å®šé›†åˆæ˜¯å¦æ˜¯æŒ‡å®šé›†åˆçš„â€‹â€‹å­é›†æˆ–è¶…é›†ï¼Œä½†ä¸ç­‰äºã€‚</li>
<li>ä½¿ç”¨è¯¥isDisjoint(with:)æ–¹æ³•ç¡®å®šä¸¤ä¸ªé›†åˆæ˜¯å¦æ²¡æœ‰å…±åŒçš„å€¼ã€‚</li>
</ul>

<pre><code class="language-text">let houseAnimals: Set = [&quot;ğŸ¶&quot;, &quot;ğŸ±&quot;]
let farmAnimals: Set = [&quot;ğŸ®&quot;, &quot;ğŸ”&quot;, &quot;ğŸ‘&quot;, &quot;ğŸ¶&quot;, &quot;ğŸ±&quot;]
let cityAnimals: Set = [&quot;ğŸ¦&quot;, &quot;ğŸ­&quot;]

houseAnimals.isSubset(of: farmAnimals)
// true
farmAnimals.isSuperset(of: houseAnimals)
// true
farmAnimals.isDisjoint(with: cityAnimals)
// true
</code></pre>

<h2 id="toc_13">åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸</h2>

<p>ä¸æ•°ç»„ä¸€æ ·ï¼Œæ‚¨å¯ä»¥Dictionaryä½¿ç”¨åˆå§‹åŒ–ç¨‹åºè¯­æ³•åˆ›å»ºæŸä¸ªç±»å‹çš„ç©ºï¼š</p>

<pre><code class="language-text">var namesOfIntegers = [Int: String]()
// namesOfIntegers is an empty [Int: String] dictionary
</code></pre>

<h2 id="toc_14">ä½¿ç”¨Dictionary Literalåˆ›å»ºå­—å…¸</h2>

<pre><code class="language-text">var airports: [String: String] = [&quot;YYZ&quot;: &quot;Toronto Pearson&quot;, &quot;DUB&quot;: &quot;Dublin&quot;]
</code></pre>

<h2 id="toc_15">è¿­ä»£å­—å…¸</h2>

<p>æ‚¨å¯ä»¥ç”¨å­—å…¸éå†é”®å€¼å¯¹for- inç¯ã€‚å­—å…¸ä¸­çš„æ¯ä¸ªé¡¹éƒ½ä½œä¸ºå…ƒç»„è¿”å›ï¼Œæ‚¨å¯ä»¥å°†å…ƒç»„çš„æˆå‘˜åˆ†è§£ä¸ºä¸´æ—¶å¸¸é‡æˆ–å˜é‡ï¼Œä½œä¸ºè¿­ä»£çš„ä¸€éƒ¨åˆ†ï¼š(key, value)</p>

<pre><code class="language-text">for (airportCode, airportName) in airports {
    print(&quot;\(airportCode): \(airportName)&quot;)
}
// LHR: London Heathrow
// YYZ: Toronto Pearson
</code></pre>

<h2 id="toc_16">SwitchåŒºé—´åŒ¹é…</h2>

<p>switchå¯ä»¥æ£€æŸ¥æ¡ˆä¾‹ä¸­çš„å€¼æ˜¯å¦åŒ…å«åœ¨é—´éš”ä¸­ã€‚æ­¤ç¤ºä¾‹ä½¿ç”¨æ•°å­—é—´éš”ä¸ºä»»ä½•å¤§å°çš„æ•°å­—æä¾›è‡ªç„¶è¯­è¨€è®¡æ•°ï¼š</p>

<pre><code class="language-text">let approximateCount = 62
let countedThings = &quot;moons orbiting Saturn&quot;
let naturalCount: String
switch approximateCount {
case 0:
    naturalCount = &quot;no&quot;
case 1..&lt;5:
    naturalCount = &quot;a few&quot;
case 5..&lt;12:
    naturalCount = &quot;several&quot;
case 12..&lt;100:
    naturalCount = &quot;dozens of&quot;
case 100..&lt;1000:
    naturalCount = &quot;hundreds of&quot;
default:
    naturalCount = &quot;many&quot;
}
print(&quot;There are \(naturalCount) \(countedThings).&quot;)
// Prints &quot;There are doze
</code></pre>

<h2 id="toc_17">å…ƒç»„</h2>

<p>æ‚¨å¯ä»¥ä½¿ç”¨å…ƒç»„åœ¨åŒä¸€switchè¯­å¥ä¸­æµ‹è¯•å¤šä¸ªå€¼ã€‚å¯ä»¥é’ˆå¯¹ä¸åŒçš„å€¼æˆ–å€¼çš„é—´éš”æ¥æµ‹è¯•å…ƒç»„çš„æ¯ä¸ªå…ƒç´ ã€‚æˆ–è€…ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿å­—ç¬¦ï¼ˆ_ï¼‰ï¼ˆä¹Ÿç§°ä¸ºé€šé…ç¬¦æ¨¡å¼ï¼‰æ¥åŒ¹é…ä»»ä½•å¯èƒ½çš„å€¼ã€‚</p>

<p>ä¸‹é¢çš„ç¤ºä¾‹é‡‡ç”¨ï¼ˆxï¼Œyï¼‰ç‚¹ï¼Œè¡¨ç¤ºä¸ºç±»å‹çš„ç®€å•å…ƒç»„ï¼Œå¹¶å°†å…¶åˆ†ç±»åœ¨ç¤ºä¾‹åé¢çš„å›¾è¡¨ä¸Šã€‚(Int, Int)</p>

<pre><code class="language-text">let somePoint = (1, 1)
switch somePoint {
case (0, 0):
    print(&quot;\(somePoint) is at the origin&quot;)
case (_, 0):
    print(&quot;\(somePoint) is on the x-axis&quot;)
case (0, _):
    print(&quot;\(somePoint) is on the y-axis&quot;)
case (-2...2, -2...2):
    print(&quot;\(somePoint) is inside the box&quot;)
default:
    print(&quot;\(somePoint) is outside of the box&quot;)
}
// Prints &quot;(1, 1) is inside the box&quot;

</code></pre>

<h2 id="toc_18">Switchä»·å€¼ç»‘å®š</h2>

<p>ä¸€ä¸ªswitchæƒ…å†µä¸‹ï¼Œå¯ä»¥å°†å…¶å‘½åä¸ºä¸´æ—¶å¸¸é‡æˆ–å˜é‡ï¼Œåœ¨æ¡ˆä»¶çš„èº«ä½“ä½¿ç”¨ç›¸åŒ¹é…çš„ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ã€‚æ­¤è¡Œä¸ºç§°ä¸ºå€¼ç»‘å®šï¼Œå› ä¸ºå€¼ç»‘å®šåˆ°æ¡ˆä¾‹æ­£æ–‡ä¸­çš„ä¸´æ—¶å¸¸é‡æˆ–å˜é‡ã€‚</p>

<p>ä¸‹é¢çš„ç¤ºä¾‹é‡‡ç”¨ï¼ˆxï¼Œyï¼‰ç‚¹ï¼Œè¡¨ç¤ºä¸ºç±»å‹çš„å…ƒç»„ï¼Œå¹¶å°†å…¶åˆ†ç±»åœ¨ä¸‹é¢çš„å›¾è¡¨ä¸Šï¼š(Int, Int)</p>

<pre><code class="language-text">let anotherPoint = (2, 0)
switch anotherPoint {
case (let x, 0):
    print(&quot;on the x-axis with an x value of \(x)&quot;)
case (0, let y):
    print(&quot;on the y-axis with a y value of \(y)&quot;)
case let (x, y):
    print(&quot;somewhere else at (\(x), \(y))&quot;)
}
// Prints &quot;on the x-axis with an x value of 2&quot;


</code></pre>

<h2 id="toc_19">Switch-where</h2>

<p>ä¸€ä¸ªswitchæƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨whereå­å¥æ¥æ£€æŸ¥é™„åŠ æ¡ä»¶ã€‚</p>

<p>ä»¥ä¸‹ç¤ºä¾‹å¯¹ä¸‹å›¾ä¸­çš„ï¼ˆxï¼Œyï¼‰ç‚¹è¿›è¡Œäº†åˆ†ç±»ï¼š</p>

<pre><code class="language-text">let yetAnotherPoint = (1, -1)
switch yetAnotherPoint {
case let (x, y) where x == y:
    print(&quot;(\(x), \(y)) is on the line x == y&quot;)
case let (x, y) where x == -y:
    print(&quot;(\(x), \(y)) is on the line x == -y&quot;)
case let (x, y):
    print(&quot;(\(x), \(y)) is just some arbitrary point&quot;)
}
// Prints &quot;(1, -1) is on the line x == -y&quot;
</code></pre>

<h2 id="toc_20">Switchå¤åˆæ¡ˆä¾‹</h2>

<p>å…±äº«ç›¸åŒä¸»ä½“çš„å¤šä¸ªå¼€å…³ç›’å¯ä»¥é€šè¿‡caseåœ¨æ¯ä¸ªæ¨¡å¼ä¹‹é—´ç”¨é€—å·åå†™å‡ ä¸ªæ¨¡å¼æ¥ç»„åˆã€‚å¦‚æœä»»ä½•æ¨¡å¼åŒ¹é…ï¼Œåˆ™è®¤ä¸ºè¯¥æƒ…å†µåŒ¹é…ã€‚å¦‚æœåˆ—è¡¨å¾ˆé•¿ï¼Œåˆ™å¯ä»¥åœ¨å¤šè¡Œä¸Šå†™å…¥æ¨¡å¼ã€‚ä¾‹å¦‚ï¼š</p>

<pre><code class="language-text">let someCharacter: Character = &quot;e&quot;
switch someCharacter {
case &quot;a&quot;, &quot;e&quot;, &quot;i&quot;, &quot;o&quot;, &quot;u&quot;:
    print(&quot;\(someCharacter) is a vowel&quot;)
case &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;,
     &quot;n&quot;, &quot;p&quot;, &quot;q&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;:
    print(&quot;\(someCharacter) is a consonant&quot;)
default:
    print(&quot;\(someCharacter) is not a vowel or a consonant&quot;)
}
// Prints &quot;e is a vowel&quot;

</code></pre>

<h2 id="toc_21">Switchå¤åˆæ¡ˆä¾‹åŒ…æ‹¬å€¼ç»‘å®š</h2>

<p>å¤åˆæ¡ˆä¾‹çš„æ‰€æœ‰æ¨¡å¼éƒ½å¿…é¡»åŒ…å«åŒä¸€ç»„å€¼ç»‘å®šï¼Œå¹¶ä¸”æ¯ä¸ªç»‘å®šå¿…é¡»ä»å¤åˆæ¡ˆä¾‹ä¸­çš„æ‰€æœ‰æ¨¡å¼ä¸­è·å–ç›¸åŒç±»å‹çš„å€¼ã€‚è¿™ç¡®ä¿äº†ï¼Œæ— è®ºå¤åˆæ¡ˆä¾‹çš„å“ªä¸ªéƒ¨åˆ†åŒ¹é…ï¼Œæ¡ˆä¾‹æ­£æ–‡ä¸­çš„ä»£ç æ€»æ˜¯å¯ä»¥è®¿é—®ç»‘å®šçš„å€¼ï¼Œå¹¶ä¸”å€¼å§‹ç»ˆå…·æœ‰ç›¸åŒçš„ç±»å‹ã€‚</p>

<pre><code class="language-text">let stillAnotherPoint = (9, 0)
switch stillAnotherPoint {
case (let distance, 0), (0, let distance):
    print(&quot;On an axis, \(distance) from the origin&quot;)
default:
    print(&quot;Not on an axis&quot;)
}
// Prints &quot;On an axis, 9 from the origin&quot;
</code></pre>

<h2 id="toc_22">Swift-fallthrough</h2>

<p>åœ¨Swiftä¸­ï¼Œswitchè¯­å¥ä¸ä¼šè½å…¥æ¯ä¸ªæ¡ˆä¾‹çš„åº•éƒ¨å¹¶è¿›å…¥ä¸‹ä¸€ä¸ªæ¡ˆä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œswitchä¸€æ—¦ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ¡ˆä¾‹å®Œæˆï¼Œæ•´ä¸ªè¯­å¥å°±å®Œæˆäº†å®ƒçš„æ‰§è¡Œã€‚ç›¸åï¼ŒCè¦æ±‚æ‚¨breakåœ¨æ¯ä¸ªswitchæ¡ˆä¾‹çš„æœ«å°¾æ’å…¥ä¸€ä¸ªæ˜ç¡®çš„è¯­å¥ï¼Œä»¥é˜²æ­¢é€šè¿‡ã€‚é¿å…é»˜è®¤çš„ä¸‹é™æ„å‘³ç€Swift switchè¯­å¥æ¯”Cä¸­çš„å¯¹åº”è¯­å¥æ›´ç®€æ´å’Œå¯é¢„æµ‹ï¼Œå› æ­¤å®ƒä»¬é¿å…switché”™è¯¯åœ°æ‰§è¡Œå¤šä¸ªæ¡ˆä¾‹ã€‚</p>

<p>å¦‚æœæ‚¨éœ€è¦Cæ ·å¼çš„ç›´é€šè¡Œä¸ºï¼Œåˆ™å¯ä»¥ä½¿ç”¨fallthroughå…³é”®å­—é€ä¸ªé€‰æ‹©åŠ å…¥æ­¤è¡Œä¸ºã€‚ä»¥ä¸‹ç¤ºä¾‹fallthroughç”¨äºåˆ›å»ºæ•°å­—çš„æ–‡æœ¬æè¿°ã€‚</p>

<pre><code class="language-text">let integerToDescribe = 5
var description = &quot;The number \(integerToDescribe) is&quot;
switch integerToDescribe {
case 2, 3, 5, 7, 11, 13, 17, 19:
    description += &quot; a prime number, and also&quot;
    fallthrough
default:
    description += &quot; an integer.&quot;
}
print(description)
// Prints &quot;The number 5 is a prime number, and also an integer.&quot;

</code></pre>

<h2 id="toc_23">æ£€æŸ¥APIå¯ç”¨æ€§</h2>

<p>Swiftå†…ç½®æ”¯æŒæ£€æŸ¥APIå¯ç”¨æ€§ï¼Œè¿™å¯ç¡®ä¿æ‚¨ä¸ä¼šæ„å¤–ä½¿ç”¨åœ¨ç»™å®šéƒ¨ç½²ç›®æ ‡ä¸Šä¸å¯ç”¨çš„APIã€‚</p>

<p>ç¼–è¯‘å™¨ä½¿ç”¨SDKä¸­çš„å¯ç”¨æ€§ä¿¡æ¯æ¥éªŒè¯ä»£ç ä¸­ä½¿ç”¨çš„æ‰€æœ‰APIæ˜¯å¦åœ¨é¡¹ç›®æŒ‡å®šçš„éƒ¨ç½²ç›®æ ‡ä¸Šå¯ç”¨ã€‚å¦‚æœæ‚¨å°è¯•ä½¿ç”¨ä¸å¯ç”¨çš„APIï¼ŒSwiftä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥å‘Šé”™è¯¯ã€‚</p>

<p>æ‚¨å¯ä»¥åœ¨or è¯­å¥ä¸­ä½¿ç”¨å¯ç”¨æ€§æ¡ä»¶æ¥æœ‰æ¡ä»¶åœ°æ‰§è¡Œä»£ç å—ï¼Œå…·ä½“å–å†³äºæ‚¨è¦ä½¿ç”¨çš„APIæ˜¯å¦åœ¨è¿è¡Œæ—¶å¯ç”¨ã€‚å½“ç¼–è¯‘å™¨éªŒè¯è¯¥ä»£ç å—ä¸­çš„APIå¯ç”¨æ—¶ï¼Œç¼–è¯‘å™¨å°†ä½¿ç”¨å¯ç”¨æ€§æ¡ä»¶ä¸­çš„ä¿¡æ¯ã€‚ifguard</p>

<pre><code class="language-text">if #available(iOS 10, macOS 10.12, *) {
    // Use iOS 10 APIs on iOS, and use macOS 10.12 APIs on macOS
} else {
    // Fall back to earlier iOS and macOS APIs
}

</code></pre>

<h2 id="toc_24">å…·æœ‰éšå«å›æŠ¥çš„å‡½æ•°</h2>

<p>å¦‚æœå‡½æ•°çš„æ•´ä¸ªä¸»ä½“æ˜¯å•ä¸ªè¡¨è¾¾å¼ï¼Œåˆ™è¯¥å‡½æ•°éšå¼è¿”å›è¯¥è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä¸¤ä¸ªå‡½æ•°éƒ½å…·æœ‰ç›¸åŒçš„è¡Œä¸ºï¼š</p>

<pre><code class="language-text">func greeting(for person: String) -&gt; String {
    &quot;Hello, &quot; + person + &quot;!&quot;
}
print(greeting(for: &quot;Dave&quot;))
// Prints &quot;Hello, Dave!&quot;

func anotherGreeting(for person: String) -&gt; String {
    return &quot;Hello, &quot; + person + &quot;!&quot;
}
print(anotherGreeting(for: &quot;Dave&quot;))
// Prints &quot;Hello, Dave!&quot;

</code></pre>

<h2 id="toc_25">å¯å˜å‚æ•°</h2>

<p>å‡½æ•°å¯ä»¥å…·æœ‰è‡³å¤šä¸€ä¸ªå¯å˜å‚æ•°ã€‚</p>

<p>å¯å˜å‚æ•°å‚æ•°æ¥å—å…·æœ‰æŒ‡å®šç±»å‹çš„é›¶å€æˆ–æ›´å¤šçš„å€¼ã€‚æ‚¨å¯ä»¥ä½¿ç”¨variadicå‚æ•°æŒ‡å®šåœ¨è°ƒç”¨å‡½æ•°æ—¶å¯ä»¥å‘å‚æ•°ä¼ é€’ä¸åŒæ•°é‡çš„è¾“å…¥å€¼ã€‚é€šè¿‡...åœ¨å‚æ•°çš„ç±»å‹åç§°åé¢æ’å…¥ä¸‰ä¸ªå¥ç‚¹å­—ç¬¦ï¼ˆï¼‰æ¥ç¼–å†™å¯å˜å‚æ•°ã€‚</p>

<p>ä¼ é€’ç»™å¯å˜å‚æ•°çš„å€¼åœ¨å‡½æ•°ä½“å†…å¯ç”¨ä½œé€‚å½“ç±»å‹çš„æ•°ç»„ã€‚ä¾‹å¦‚ï¼Œåœ¨å‡½æ•°ä½“å†…å¯ä»¥ä½¿ç”¨åç§°numberså’Œç±»å‹çš„å¯å˜å‚æ•°Double...ä½œä¸ºåä¸ºnumberstype çš„å¸¸é‡æ•°ç»„[Double]ã€‚</p>

<p>ä¸‹é¢çš„ç¤ºä¾‹è®¡ç®—ä»»æ„é•¿åº¦çš„æ•°å­—åˆ—è¡¨çš„ç®—æœ¯å¹³å‡å€¼ï¼ˆä¹Ÿç§°ä¸ºå¹³å‡å€¼ï¼‰ï¼š</p>

<pre><code class="language-text">func arithmeticMean(_ numbers: Double...) -&gt; Double {
    var total: Double = 0
    for number in numbers {
        total += number
    }
    return total / Double(numbers.count)
}
arithmeticMean(1, 2, 3, 4, 5)
// returns 3.0, which is the arithmetic mean of these five numbers
arithmeticMean(3, 8.25, 18.75)
// returns 10.0, which is the arithmetic mean of these three numbers
</code></pre>

<h2 id="toc_26">è¿›å‡ºå‚æ•°</h2>

<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°å‚æ•°æ˜¯å¸¸é‡ã€‚å°è¯•ä»è¯¥å‡½æ•°ä½“å†…æ›´æ”¹å‡½æ•°å‚æ•°çš„å€¼ä¼šå¯¼è‡´ç¼–è¯‘æ—¶é”™è¯¯ã€‚è¿™æ„å‘³ç€æ‚¨æ— æ³•é”™è¯¯åœ°æ›´æ”¹å‚æ•°çš„å€¼ã€‚å¦‚æœå¸Œæœ›å‡½æ•°ä¿®æ”¹å‚æ•°çš„å€¼ï¼Œå¹¶ä¸”å¸Œæœ›åœ¨å‡½æ•°è°ƒç”¨ç»“æŸåè¿™äº›æ›´æ”¹ä»ç„¶å­˜åœ¨ï¼Œè¯·å°†è¯¥å‚æ•°å®šä¹‰ä¸ºè¾“å…¥è¾“å‡ºå‚æ•°ã€‚</p>

<p>æ‚¨åªèƒ½å°†å˜é‡ä½œä¸ºè¾“å…¥è¾“å‡ºå‚æ•°çš„å‚æ•°ä¼ é€’ã€‚æ‚¨ä¸èƒ½ä¼ é€’å¸¸é‡æˆ–æ–‡å­—å€¼ä½œä¸ºå‚æ•°ï¼Œå› ä¸ºä¸èƒ½ä¿®æ”¹å¸¸é‡å’Œæ–‡å­—ã€‚&amp;å½“æ‚¨å°†å˜é‡åç§°ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¾“å…¥è¾“å‡ºå‚æ•°æ—¶ï¼Œå¯ä»¥å°†å˜é‡åç§°ç›´æ¥æ”¾åœ¨å˜é‡åç§°ä¹‹å‰ï¼Œä»¥æŒ‡ç¤ºå®ƒå¯ä»¥è¢«å‡½æ•°ä¿®æ”¹ã€‚</p>

<p>è¾“å…¥è¾“å‡ºå‚æ•°ä¸èƒ½å…·æœ‰é»˜è®¤å€¼ï¼Œå¹¶ä¸”ä¸å¯å˜å‚æ•°ä¸èƒ½æ ‡è®°ä¸ºinoutã€‚</p>

<p>è¿™æ˜¯ä¸€ä¸ªåä¸ºçš„å‡½æ•°ç¤ºä¾‹swapTwoInts(_:_:)ï¼Œå®ƒæœ‰ä¸¤ä¸ªè¾“å…¥è¾“å‡ºçš„æ•´æ•°å‚æ•°ï¼Œaå¹¶ä¸”bï¼š</p>

<pre><code class="language-text">func swapTwoInts(_ a: inout Int, _ b: inout Int) {
    let temporaryA = a
    a = b
    b = temporaryA
}
</code></pre>

<p>è¯¥swapTwoInts(_:_:)å‡½æ•°ç®€å•åœ°äº¤æ¢binto açš„å€¼å’Œainto çš„å€¼bã€‚è¯¥å‡½æ•°é€šè¿‡å°†å€¼å­˜å‚¨aåœ¨ä¸€ä¸ªè¢«è°ƒç”¨çš„ä¸´æ—¶å¸¸é‡temporaryAï¼ŒæŒ‡å®šbto çš„å€¼aï¼Œç„¶ååˆ†é…ç»™å®ƒtemporaryAæ¥æ‰§è¡Œæ­¤äº¤æ¢bã€‚</p>

<p>æ‚¨å¯ä»¥swapTwoInts(_:_:)ä½¿ç”¨ä¸¤ä¸ªç±»å‹çš„å˜é‡è°ƒç”¨è¯¥å‡½æ•°Intæ¥äº¤æ¢å®ƒä»¬çš„å€¼ã€‚è¯·æ³¨æ„ï¼Œä¼ é€’ç»™å‡½æ•°æ—¶ï¼ŒsomeIntå’Œçš„åç§°anotherIntå‰ç¼€ä¸ºï¼†ç¬¦å·swapTwoInts(_:_:)ï¼š</p>

<pre><code class="language-text">var someInt = 3
var anotherInt = 107
swapTwoInts(&amp;someInt, &amp;anotherInt)
print(&quot;someInt is now \(someInt), and anotherInt is now \(anotherInt)&quot;)
// Prints &quot;someInt is now 107, and anotherInt is now 3&quot;
</code></pre>

<p>ä¸Šé¢çš„ç¤ºä¾‹æ˜¾ç¤ºå‡½æ•°çš„åŸå§‹å€¼someIntå’ŒanotherIntç”±swapTwoInts(_:_:)å‡½æ•°ä¿®æ”¹ï¼Œå³ä½¿å®ƒä»¬æœ€åˆæ˜¯åœ¨å‡½æ•°å¤–éƒ¨å®šä¹‰çš„ã€‚</p>

<p>è¾“å…¥è¾“å‡ºå‚æ•°ä¸ä»å‡½æ•°è¿”å›å€¼ä¸åŒã€‚swapTwoIntsä¸Šé¢çš„ç¤ºä¾‹æ²¡æœ‰å®šä¹‰è¿”å›ç±»å‹æˆ–è¿”å›å€¼ï¼Œä½†å®ƒä»ç„¶ä¿®æ”¹äº†someIntå’Œçš„å€¼anotherIntã€‚è¾“å…¥è¾“å‡ºå‚æ•°æ˜¯å‡½æ•°åœ¨å…¶å‡½æ•°ä½“èŒƒå›´ä¹‹å¤–äº§ç”Ÿæ•ˆæœçš„å¦ä¸€ç§æ–¹æ³•ã€‚</p>

<h2 id="toc_27">åµŒå¥—å‡½æ•°</h2>

<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨åœ¨æœ¬ç« ä¸­é‡åˆ°çš„æ‰€æœ‰å‡½æ•°éƒ½æ˜¯å…¨å±€å‡½æ•°çš„ç¤ºä¾‹ï¼Œè¿™äº›å‡½æ•°åœ¨å…¨å±€èŒƒå›´å†…å®šä¹‰ã€‚æ‚¨è¿˜å¯ä»¥åœ¨å…¶ä»–å‡½æ•°ä½“å†…å®šä¹‰å‡½æ•°ï¼Œç§°ä¸ºåµŒå¥—å‡½æ•°ã€‚</p>

<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåµŒå¥—å‡½æ•°å¯¹å¤–ç•Œæ˜¯éšè—çš„ï¼Œä½†å®ƒä»¬çš„å°é—­å‡½æ•°ä»ç„¶å¯ä»¥è°ƒç”¨å®ƒä»¬ã€‚å°é—­å‡½æ•°ä¹Ÿå¯ä»¥è¿”å›å…¶åµŒå¥—å‡½æ•°ä¹‹ä¸€ï¼Œä»¥å…è®¸åµŒå¥—å‡½æ•°åœ¨å¦ä¸€ä¸ªèŒƒå›´å†…ä½¿ç”¨ã€‚</p>

<p>æ‚¨å¯ä»¥é‡å†™chooseStepFunction(backward:)ä¸Šé¢çš„ç¤ºä¾‹ä»¥ä½¿ç”¨å’Œè¿”å›åµŒå¥—å‡½æ•°ï¼š</p>

<pre><code class="language-text">func chooseStepFunction(backward: Bool) -&gt; (Int) -&gt; Int {
    func stepForward(input: Int) -&gt; Int { return input + 1 }
    func stepBackward(input: Int) -&gt; Int { return input - 1 }
    return backward ? stepBackward : stepForward
}
var currentValue = -4
let moveNearerToZero = chooseStepFunction(backward: currentValue &gt; 0)
// moveNearerToZero now refers to the nested stepForward() function
while currentValue != 0 {
    print(&quot;\(currentValue)... &quot;)
    currentValue = moveNearerToZero(currentValue)
}
print(&quot;zero!&quot;)
// -4...
// -3...
// -2...
// -1...
// zero!

</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2020/12/11</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="16076509809415.html">
                
                  <h1>ä¸€ä¸ªå®ä¾‹å¯¹è±¡å¯ä»¥é€šè¿‡4ç§æ–¹å¼è°ƒç”¨å…¶æ–¹æ³•ã€‚</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<pre><code class="language-text">- (void)test{
    
//type1
    [self printStr1:@&quot;hello world 1&quot;];
    
//type2
    [self performSelector:@selector(printStr1:) withObject:@&quot;hello world 2&quot;];
    
//type3
    //è·å–æ–¹æ³•ç­¾å
    NSMethodSignature *sigOfPrintStr = [self methodSignatureForSelector:@selector(printStr1:)];
    
    //è·å–æ–¹æ³•ç­¾åå¯¹åº”çš„invocation
    NSInvocation *invocationOfPrintStr = [NSInvocation invocationWithMethodSignature:sigOfPrintStr];
    
    /**
    è®¾ç½®æ¶ˆæ¯æ¥å—è€…ï¼Œä¸[invocationOfPrintStr setArgument:(__bridge void * _Nonnull)(self) atIndex:0]ç­‰ä»·
    */
    [invocationOfPrintStr setTarget:self];
    
    /**è®¾ç½®è¦æ‰§è¡Œçš„selectorã€‚ä¸[invocationOfPrintStr setArgument:@selector(printStr1:) atIndex:1] ç­‰ä»·*/
    [invocationOfPrintStr setSelector:@selector(printStr1:)];
    
    //è®¾ç½®å‚æ•° 
    NSString *str = @&quot;hello world 3&quot;;
    [invocationOfPrintStr setArgument:&amp;str atIndex:2];
    
    //å¼€å§‹æ‰§è¡Œ
    [invocationOfPrintStr invoke];
    
    //type4
    ((void (*)(id,SEL,NSString *, NSArray *, NSInteger))objc_msgSend)(self, @selector(textFunctionWithParam:param2:param3:),@&quot;111&quot;,@[@2,@3],123);

}
-(void)textFunctionWithParam:(NSString *)param1 param2:(NSArray *)param2 param3:(NSInteger)param3 {
    NSLog(@&quot;param1:%@, param2:%@, param3:%ld&quot;,param1, param2, param3);
}
- (void)printStr1:(NSString*)str{
    NSLog(@&quot;printStr1  %@&quot;,str);
}


</code></pre>

<h2 id="toc_0">ä¸‹é¢å±•ç¤ºblock çš„ä¸¤ç§è°ƒç”¨æ–¹å¼</h2>

<pre><code class="language-text">- (void)test{

    void (^block1)(int) = ^(int a){
         NSLog(@&quot;block1 %d&quot;,a);
    };
    
    //type1
    block1(1);
    
    //type2
    //è·å–blockç±»å‹å¯¹åº”çš„æ–¹æ³•ç­¾åã€‚
    NSMethodSignature *signature = aspect_blockMethodSignature(block1);
    NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:signature];
    [invocation setTarget:block1];
    int a=2;
    [invocation setArgument:&amp;a atIndex:1];
    [invocation invoke];
}

</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2020/12/11</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="16076509809509.html">
                
                  <h1>block</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>å¦‚æœä½¿ç”¨weakä¿®é¥°blockï¼Œé‚£ä¹ˆå°†æœ‰å¯èƒ½å‡ºç°é‡æŒ‡é’ˆçš„é”™è¯¯é—®é¢˜</p>

<p>é‚£ä¹ˆstrong å’Œ copy æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ </p>

<p>blockæœ¬èº«æ˜¯åƒå¯¹è±¡ä¸€æ ·å¯ä»¥r****etainï¼Œå’Œreleaseã€‚ä½†æ˜¯ï¼Œblockåœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œå®ƒçš„å†…å­˜æ˜¯åˆ†é…åœ¨æ ˆä¸Šçš„ï¼Œè€Œä¸æ˜¯åœ¨å †ä¸Šã€‚ä»–æœ¬èº«çš„ä½œäºåŸŸæ˜¯å±äºåˆ›å»ºæ—¶å€™çš„ä½œç”¨åŸŸï¼Œä¸€æ—¦åœ¨åˆ›å»ºæ—¶å€™çš„ä½œç”¨åŸŸå¤–é¢è°ƒç”¨blockå°†å¯¼è‡´ç¨‹åºå´©æºƒã€‚å› ä¸ºæ ˆåŒºçš„ç‰¹ç‚¹å°±æ˜¯åˆ›å»ºçš„å¯¹è±¡éšæ—¶å¯èƒ½è¢«é”€æ¯,ä¸€æ—¦è¢«é”€æ¯åç»­å†æ¬¡è°ƒç”¨ç©ºå¯¹è±¡å°±å¯èƒ½ä¼šé€ æˆç¨‹åºå´©æºƒ,åœ¨å¯¹blockè¿›è¡Œcopyå,blockå­˜æ”¾åœ¨å †åŒº.<br/>
ä½¿ç”¨retainä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯blockçš„retainè¡Œä¸ºé»˜è®¤æ˜¯ç”¨copyçš„è¡Œä¸ºå®ç°çš„ï¼Œ<br/>
å› ä¸ºblockå˜é‡é»˜è®¤æ˜¯å£°æ˜ä¸ºæ ˆå˜é‡çš„ï¼Œä¸ºäº†èƒ½å¤Ÿåœ¨blockçš„å£°æ˜åŸŸå¤–ä½¿ç”¨ï¼Œæ‰€ä»¥è¦æŠŠblockæ‹·è´ï¼ˆcopyï¼‰åˆ°å †ï¼Œæ‰€ä»¥è¯´ä¸ºäº†blockå±æ€§å£°æ˜å’Œå®é™…çš„æ“ä½œä¸€è‡´ï¼Œæœ€å¥½å£°æ˜ä¸ºcopyã€‚</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2020/12/11</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="16076509809545.html">
                
                  <h1>Autorelease Pool çš„ç”¨å¤„</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>åœ¨ ARC ä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ autorelease æœ‰å…³çš„æ–¹æ³•ï¼Œç”šè‡³å¯ä»¥å®Œå…¨ä¸çŸ¥é“ autorelease çš„å­˜åœ¨ï¼Œå°±å¯ä»¥æ­£ç¡®ç®¡ç†å¥½å†…å­˜ã€‚å› ä¸º Cocoa Touch çš„ Runloop ä¸­ï¼Œæ¯ä¸ª runloop circle ä¸­ç³»ç»Ÿéƒ½è‡ªåŠ¨åŠ å…¥äº† Autorelease Pool çš„åˆ›å»ºå’Œé‡Šæ”¾ã€‚</p>

<p>å½“æˆ‘ä»¬éœ€è¦åˆ›å»ºå’Œé”€æ¯å¤§é‡çš„å¯¹è±¡æ—¶ï¼Œä½¿ç”¨æ‰‹åŠ¨åˆ›å»ºçš„ autoreleasepool å¯ä»¥æœ‰æ•ˆçš„é¿å…å†…å­˜å³°å€¼çš„å‡ºç°ã€‚å› ä¸ºå¦‚æœä¸æ‰‹åŠ¨åˆ›å»ºçš„è¯ï¼Œå¤–å±‚ç³»ç»Ÿåˆ›å»ºçš„ pool ä¼šåœ¨æ•´ä¸ª runloop circle ç»“æŸä¹‹åæ‰è¿›è¡Œ drainï¼Œæ‰‹åŠ¨åˆ›å»ºçš„è¯ï¼Œä¼šåœ¨ block ç»“æŸä¹‹åå°±è¿›è¡Œ drain æ“ä½œã€‚è¯¦æƒ…è¯·å‚è€ƒè‹¹æœå®˜æ–¹æ–‡æ¡£ã€‚ä¸€ä¸ªæ™®éè¢«ä½¿ç”¨çš„ä¾‹å­å¦‚ä¸‹ï¼š</p>

<pre><code class="language-text">for (int i = 0; i &lt; 100000000; i++)
{
    @autoreleasepool
    {
        NSString* string = @&quot;ab c&quot;;
        NSArray* array = [string componentsSeparatedByString:string];
    }
}
</code></pre>

<p>å¦‚æœä¸ä½¿ç”¨ autoreleasepool ï¼Œéœ€è¦åœ¨å¾ªç¯ç»“æŸä¹‹åé‡Šæ”¾ 100000000 ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœ<br/>
ä½¿ç”¨çš„è¯ï¼Œåˆ™ä¼šåœ¨æ¯æ¬¡å¾ªç¯ç»“æŸçš„æ—¶å€™éƒ½è¿›è¡Œ release æ“ä½œã€‚</p>

<h2 id="toc_0">Autorelease Pool è¿›è¡Œ Drain çš„æ—¶æœº</h2>

<p>å¦‚ä¸Šé¢æ‰€è¯´ï¼Œç³»ç»Ÿåœ¨ runloop ä¸­åˆ›å»ºçš„ autoreleaspool ä¼šåœ¨ runloop ä¸€ä¸ª event ç»“æŸæ—¶è¿›è¡Œé‡Šæ”¾æ“ä½œã€‚æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºçš„ autoreleasepool ä¼šåœ¨ block æ‰§è¡Œå®Œæˆä¹‹åè¿›è¡Œ drain æ“ä½œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>

<p>å½“ block ä»¥å¼‚å¸¸ï¼ˆexceptionï¼‰ç»“æŸæ—¶ï¼Œpool ä¸ä¼šè¢« drain</p>

<p>Pool çš„ drain æ“ä½œä¼šæŠŠæ‰€æœ‰æ ‡è®°ä¸º autorelease çš„å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å‡ä¸€ï¼Œä½†æ˜¯å¹¶ä¸æ„å‘³ç€è¿™ä¸ªå¯¹è±¡ä¸€å®šä¼šè¢«é‡Šæ”¾æ‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ autorelease pool ä¸­æ‰‹åŠ¨ retain å¯¹è±¡ï¼Œä»¥å»¶é•¿å®ƒçš„ç”Ÿå‘½å‘¨æœŸï¼ˆåœ¨ MRC ä¸­ï¼‰ã€‚</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2020/12/11</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
              


			<div class="row">
			  <div class="large-6 columns">
			  <p class="text-left" style="padding-top:25px;">
			   <a href="all_11.html">&laquo; Prev Page</a>  
			  </p>
			  </div>
			  <div class="large-6 columns">
			<p class="text-right" style="padding-top:25px;">
			 <a href="all_13.html">&raquo; Next Page</a> 
			</p>
			  </div>
			</div>
		</div>
	</div><!-- large 8 -->

 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="/Users/cnsunrun/Desktop/507369_large.png" /></div>
            
                <h1></h1>
                <div class="site-des"></div>
                <div class="social">










<a target="_blank" class="email" href="mailto:maweefeng@gmail.com" title="Email">Email</a>
  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="%E7%94%B5%E5%BD%B1.html"><strong>ç”µå½±</strong></a>
        
            <a href="%E5%85%B6%E5%AE%83.html"><strong>å…¶å®ƒ</strong></a>
        
            <a href="Python.html"><strong>Python</strong></a>
        
            <a href="iOS.html"><strong>iOS</strong></a>
        
            <a href="%E6%88%91.html"><strong>æˆ‘</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="16076509803956.html">Xcode10æŠ¥é”™libstdc</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16076509804011.html">Masonryå¸ƒå±€â€œUnable to simultaneously satisfy constraintsâ€</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16076509804045.html">RACCommand</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16076509804076.html">ä»£ç†ä¿®é¥°ç¬¦</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16076509804110.html">You donâ€™t have write permissions</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
