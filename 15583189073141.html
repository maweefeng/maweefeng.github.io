<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>
    
    Djangoå…¥é—¨ â€” å»ºç«‹ç®€æ˜“åšå®¢ä»¥åŠORMå…³ç³»ä»‹ç» - Code Log ğŸ‘¨â€ğŸ’»â€ 
    
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="Code Log ğŸ‘¨â€ğŸ’»â€ " type="application/atom+xml">
  <link rel="stylesheet" href="asset/css/foundation.min.css" />
  <link rel="stylesheet" href="asset/css/docs.css" />
  <script src="asset/js/vendor/modernizr.js"></script>
  <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>
    hljs.initHighlightingOnLoad();

    window.onload = function () {

      var footerPath = window.location.pathname.split('/')[window.location.pathname.split('/').length - 1];
      if (footerPath == 'archives.html') {
        // alert('åˆ†ç±»');
        document.getElementById('main-menu').getElementsByTagName("li")[1].className = "is_active";

      } else if (footerPath == 'about.html') {
        document.getElementById('main-menu').getElementsByTagName("li")[2].className = "is_active";

        // alert('å…³äºæˆ‘');
  
      } else {
        // alert('é¦–é¡µ');
        document.getElementById('main-menu').getElementsByTagName("li")[0].className = "is_active";
      }


    }
  </script>
  <script type="text/javascript">
    function before_search() {
      var searchVal = 'site: ' + document.getElementById('search_input').value;
      document.getElementById('search_q').value = searchVal;
      return true;
    }
  </script>
</head>

<body class="antialiased hide-extras">

  <div class="marketing off-canvas-wrap" data-offcanvas>
    <div class="inner-wrap">


      <nav class="top-bar docs-bar hide-for-small" data-topbar>


        <section class="top-bar-section">
          <div class="row">
            <div style="position: relative;width:100%;">
              <div style="position: absolute; width:100%;">
                <ul id="main-menu" class="left">
                  
                  <li id=""><a id="" target="_self" href="index.html">Home</a></li>
                  
                  <li id=""><a id="" target="_self" href="archives.html">Archives</a></li>
                  
                  <li id=""><a id="" target="_self" href="about.html">About</a></li>
                  
                </ul>

                <ul class="right" id="search-wrap">
                  <li>
                    <form target="_blank" onsubmit="return before_search();" action="http://google.com/search" method="get">
                      <input type="hidden" id="search_q" name="q" value="" />
                      <input tabindex="1" type="search" id="search_input" placeholder="Search" />
                    </form>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </section>

      </nav>

      <nav class="tab-bar show-for-small">
        <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
          <span> &nbsp; Code Log ğŸ‘¨â€ğŸ’»â€ </span>
        </a>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">

          <li><a href="index.html">Home</a></li>
          <li><a href="archives.html">Archives</a></li>
          
          <li><label>Categories</label></li>

          
          <li id="iOS"><a href="iOS.html">iOS</a></li>
          
          <li id="Git"><a href="Git.html">Git</a></li>
          
          <li id="CocoaPods"><a href="CocoaPods.html">CocoaPods</a></li>
          
          <li id="Django"><a href="Django.html">Django</a></li>
          
          <li id="about"><a href="about.html">about</a></li>
          

        </ul>
      </aside>

      <a class="exit-off-canvas" href="#"></a>


      <section id="main-content" role="main" class="scroll-container"> <script type="text/javascript">
  $(function () {
    $('#menu_item_index').addClass('is_active');
  });
</script>
<div class="row">
  <div class="large-8 medium-8 columns">
    <div class="markdown-body article-wrap">
      <div class="article">
        
        <h1>Djangoå…¥é—¨ â€” å»ºç«‹ç®€æ˜“åšå®¢ä»¥åŠORMå…³ç³»ä»‹ç»</h1>

        <div class="read-more clearfix">
          <span class="date">2019/5/20</span>

          <span>posted in&nbsp;</span> 
          
          <span class="posted-in"><a href='Django.html'>Django</a></span>
          

          <span class="comments">
            

            
          </span>

        </div>
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
        <div class="addthis_inline_share_toolbox"></div>
      </div><!-- article -->

      <div class="article-content">
        <ul>
<li>å¼€æºçš„Python Webæ¡†æ¶</li>
<li>MVCæ¨¡å¼</li>
</ul>

<blockquote>
<p>ä½¿ç”¨Django å¿…é¡»å…ˆå®‰è£…Pythonï¼Œæ¨èå®‰è£…3.0ç‰ˆæœ¬ä»¥ä¸Šçš„Python3<br/>
ç„¶åå†ç”¨pipå®‰è£…å·¥å…·å®‰è£…Django<br/>
ç”±äºæˆ‘å®‰è£…çš„æ˜¯python3 æ‰€ä»¥æˆ‘çš„pipå·¥å…·æ˜¯pip3<br/>
å®‰è£…å‘½ä»¤<code>pip3 install django==2.0</code><br/>
æœ€åé€‰æ‹©é€‚åˆè‡ªå·±çš„IDE<br/>
æˆ‘ä½¿ç”¨çš„æ˜¯VSCode</p>
</blockquote>

<h2 id="toc_0">ä¼˜ç‚¹</h2>

<ul>
<li>å¼€å‘æ•ˆç‡é«˜</li>
<li>åŠŸèƒ½å¼ºå¤§ï¼Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹æ’ä»¶</li>
<li>é‡è§†å®‰å…¨ï¼Œé¿å…å®‰å…¨æ¼æ´</li>
</ul>

<p>å‘½ä»¤è¯­å¥django-admin æ£€æŸ¥djangoæ˜¯å¦æˆåŠŸå®‰è£…ã€‚</p>

<p><img src="media/15583189073141/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-05-20%20%E4%B8%8A%E5%8D%8811.19.16.png" alt="å±å¹•å¿«ç…§ 2019-05-20 ä¸Šåˆ11.19.16"/></p>

<ul>
<li>startproject # åˆ›å»ºä¸€ä¸ªdjangoé¡¹ç›®</li>
<li>startapp # åˆ›å»ºä¸€ä¸ªdjangoåº”ç”¨</li>
<li>check # æ£€éªŒé¡¹ç›®å®Œæ•´æ€§</li>
<li>runserver # æœ¬åœ°ç®€æ˜“è¿è¡Œdjangoé¡¹ç›®</li>
<li>shell # è¿›å…¥djangoé¡¹ç›®çš„python shellç¯å¢ƒ</li>
<li>test # æ‰§è¡Œdjangoç”¨ä¾‹æµ‹è¯•</li>
</ul>

<p>æ•°æ®åº“ç›¸å…³</p>

<ul>
<li>makemigrations # åˆ›å»ºæ¨¡å‹å˜æ›´çš„è¿ç§»æ–‡ä»¶</li>
<li>migrate # æ‰§è¡Œä¸Šä¸€ä¸ªå‘½ä»¤åˆ›å»ºçš„è¿ç§»æ–‡ä»¶</li>
<li>dumpdata # æŠŠæ•°æ®åº“æ•°æ®å¯¼å‡ºåˆ°æ–‡ä»¶</li>
<li>loaddata # æŠŠæ–‡ä»¶æ•°æ®å¯¼å…¥åˆ°æ•°æ®åº“</li>
</ul>

<h2 id="toc_1">Django åº”ç”¨ VS Djangoé¡¹ç›®</h2>

<p>é¦–å…ˆè¦æ˜ç™½Djangoé¡¹ç›®å’Œåº”ç”¨çš„åŒºåˆ«</p>

<ul>
<li>1ä¸ªDjangoé¡¹ç›®å°±æ˜¯ä¸€ä¸ªåŸºäºDjangoçš„webåº”ç”¨</li>
<li>1ä¸ªDjangoåº”ç”¨å°±æ˜¯ä¸€ä¸ªå¯é‡ç”¨çš„pythonè½¯ä»¶åŒ…</li>
<li>1ä¸ªDjangoåº”ç”¨å¯ä»¥è‡ªå·±ç®¡ç†æ¨¡å‹è§†å›¾æ¨¡ç‰ˆè·¯ç”±å’Œé™æ€æ–‡ä»¶</li>
<li>1ä¸ªDjangoé¡¹ç›®å¯ä»¥åŒ…å«ä¸€ç»„é…ç½®å’Œè‹¥å¹²ä¸ªDjangoåº”ç”¨ã€‚</li>
</ul>

<hr/>

<h3 id="toc_2">åˆ›å»ºä¸€ä¸ªDjangoé¡¹ç›®</h3>

<ol>
<li><p>åˆ›å»ºä¸€ä¸ªé¡¹ç›®</p>

<pre><code>django-admin startproject django_intrduction
</code></pre></li>
<li><p>ç”¨VSCodeæ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹</p>

<p>ç»“æ„ç›®å½•å¦‚ä¸‹</p>

<p>Django_instrduction</p>

<ul>
<li><p>Django_instrduction</p>

<ul>
<li>__init__.py//é¡¹ç›®åˆå§‹åŒ–</li>
<li>setting.py//ğŸŒŸé¡¹ç›®é…ç½®æ–‡ä»¶</li>
<li>urls.py//é¡¹ç›®è·¯ç”±é…ç½®æ–‡ä»¶</li>
<li>wsgi.py//pythonæœåŠ¡å™¨ç½‘å…³æ¥å£</li>
</ul></li>
<li><p>manage.py//é¡¹ç›®ç®¡ç†æ–‡ä»¶ </p></li>
</ul></li>
<li><p>è¿è¡Œé¡¹ç›® ç»ˆç«¯å‘½ä»¤<code>python3 manage.py runserver</code></p></li>
</ol>

<h4 id="toc_3">Djangoé¡¹ç›®é‡è¦æ–‡ä»¶ä»‹ç»</h4>

<h5 id="toc_4">setting.py</h5>

<pre><code>import os

# Build paths inside the project like this: os.path.join(BASE_DIR, ...)
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))#é¡¹ç›®æ ¹ç›®å½•


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/2.0/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = &#39;7bet#*gq%**^7*)5m%)avx&amp;sg6yv_^&amp;t5b!@8+$(&amp;of&amp;_^1wv)&#39;#é¡¹ç›®å®‰å…¨ç 

# SECURITY WARNING: don&#39;t run with debug turned on in production!
DEBUG = True #ä¸è¦åœ¨æ­£å¼ç¯å¢ƒä¸­æ‰“å¼€ å¦‚æœæ‰“å¼€çš„è¯å¼‚å¸¸ä¼šæŠ›åˆ°å‰ç«¯

ALLOWED_HOSTS = []
#ALLOWED_HOSTS = [&#39;localhost&#39;] åªå…è®¸hostæ˜¯æ•°ç»„ä¸­çš„å†…å®¹çš„åœ°å€è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™ å…¶ä»–åœ°å€éƒ½å±è”½äº†


# Application definition

INSTALLED_APPS = [
    &#39;django.contrib.admin&#39;,
    &#39;django.contrib.auth&#39;,
    &#39;django.contrib.contenttypes&#39;,
    &#39;django.contrib.sessions&#39;,
    &#39;django.contrib.messages&#39;,
    &#39;django.contrib.staticfiles&#39;,
    &#39;blog.apps.BlogConfig&#39;,#è‡ªå·±åˆ›å»ºçš„åº”ç”¨è¦å†™åœ¨è¿™é‡Œé¢ æ‰èƒ½è¢«è¯†åˆ«
]

MIDDLEWARE = [
    &#39;django.middleware.security.SecurityMiddleware&#39;,
    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
    &#39;django.middleware.common.CommonMiddleware&#39;,
    &#39;django.middleware.csrf.CsrfViewMiddleware&#39;,
    &#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;,
    &#39;django.contrib.messages.middleware.MessageMiddleware&#39;,
    &#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;,
]

ROOT_URLCONF = &#39;django_intrduction.urls&#39;

#djangoä¸­çš„æ¨¡æ¿å°±æ˜¯ä¸€ä¸ªä¸ªçš„htmlæ–‡ä»¶
TEMPLATES = [
    {
        &#39;BACKEND&#39;: &#39;django.template.backends.django.DjangoTemplates&#39;,
        &#39;DIRS&#39;: [],
        &#39;APP_DIRS&#39;: True,
        &#39;OPTIONS&#39;: {
            &#39;context_processors&#39;: [
                &#39;django.template.context_processors.debug&#39;,
                &#39;django.template.context_processors.request&#39;,
                &#39;django.contrib.auth.context_processors.auth&#39;,
                &#39;django.contrib.messages.context_processors.messages&#39;,
            ],
        },
    },
]


</code></pre>

<h3 id="toc_5">åˆ›å»ºä¸€ä¸ªDjangoåº”ç”¨</h3>

<ol>
<li><p>åˆ›å»ºä¸€ä¸ªåº”ç”¨</p>

<p>è¿è¡Œé¡¹ç›® ç»ˆç«¯å‘½ä»¤<code>python3 manage.py startapp åº”ç”¨å</code></p></li>
<li><p>ç”¨VSCodeæ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹</p>

<p>ç»“æ„ç›®å½•å¦‚ä¸‹</p>

<p>Django_instrduction</p>

<ul>
<li><p>åº”ç”¨å</p>

<ul>
<li>views.py//ğŸŒŸæ‰§è¡Œå“åº”çš„ä»£ç æ‰€åœ¨æ¨¡å—ï¼Œå¤§éƒ¨åˆ†ä»£ç éƒ½åœ¨è¿™é‡Œ</li>
<li>models.py//å®šä¹‰åº”ç”¨æ¨¡å‹ã€ä½¿ç”¨ormæ¡†æ¶</li>
<li>apps.py //å£°æ˜åº”ç”¨çš„åœ°æ–¹</li>
<li>admin.py //å®šä¹‰adminæ¨¡å—ç®¡ç†çš„åœ°æ–¹ã€åå°ç®¡ç†é…ç½®</li>
<li>tests.py //è‡ªåŠ¨åŒ–æµ‹è¯•æ¨¡å—ï¼Œç¼–å†™æµ‹è¯•ç”¨ä¾‹çš„åœ°æ–¹ </li>
<li>urls.py //ï¼ˆè‡ªè¡Œåˆ›å»ºï¼‰ç®¡ç†åº”ç”¨è·¯ç”±çš„åœ°æ–¹</li>
</ul></li>
<li><p>Django_instrduction</p>

<ul>
<li>__init__.py//é¡¹ç›®åˆå§‹åŒ–</li>
<li>setting.py//é¡¹ç›®é…ç½®æ–‡ä»¶</li>
<li>urls.py//é¡¹ç›®è·¯ç”±é…ç½®æ–‡ä»¶</li>
<li>wsgi.py</li>
</ul></li>
<li><p>manage.py//é¡¹ç›®ç®¡ç†æ–‡ä»¶ </p></li>
</ul></li>
</ol>

<h2 id="toc_6">Django HelloWorld</h2>

<h3 id="toc_7">Django è§†å›¾</h3>

<blockquote>
<p>å¤§éƒ¨åˆ†ä»£ç éƒ½å†™åœ¨views.pyå½“ä¸­ï¼Œæ‰€ä»¥ç¼–è¾‘viewsæ˜¯éå¸¸é‡è¦çš„ï¼Œ</p>
</blockquote>

<ul>
<li>æ¯ä¸ªå“åº”å¯¹åº”ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå“åº”ã€‚</li>
<li>å‡½æ•°å¿…é¡»å­˜åœ¨ä¸€ä¸ªå‚æ•°ï¼Œä¸€èˆ¬çº¦å®šä¸ºrequest</li>
<li>æ¯ä¸ªå“åº”å‡½æ•°å¯¹åº”ä¸€ä¸ªurl</li>
</ul>

<pre><code>//views.py
from django.shortcuts import render
from django.http import HttpResponse
# Create your views here.
def hello_world(request):
    return HttpResponse(&quot;hello world&quot;)
</code></pre>

<h3 id="toc_8">Django è·¯ç”±</h3>

<ul>
<li>æ¯ä¸ªURLéƒ½ä»¥urlçš„å½¢å¼å†™å‡ºæ¥</li>
<li>urlå‡½æ•°æ”¾åœ¨urlpatternsåˆ—è¡¨ä¸­</li>
</ul>

<pre><code>åº”ç”¨è·¯ç”±
from django.urls import path,include

import blog.views


urlpatterns = [
    path(&quot;hello_world&quot;,blog.views.hello_world)
]
</code></pre>

<pre><code>é¡¹ç›®è·¯ç”±
from django.contrib import admin
from django.urls import path,include

urlpatterns = [
    path(&#39;admin/&#39;, admin.site.urls),
    path(&#39;blog/&#39;, include(&quot;blog.urls&quot;)),
]

</code></pre>

<h2 id="toc_9">æ¦‚å¿µä»‹ç»åŠå®æˆ˜</h2>

<h4 id="toc_10">Django æ¨¡å‹</h4>

<h5 id="toc_11">æ¨¡å‹å±‚ç®€ä»‹</h5>

<h6 id="toc_12">æ¨¡å‹å±‚æ˜¯ä»€ä¹ˆ</h6>

<ul>
<li>ä½äºè§†å›¾å±‚å’Œæ•°æ®åº“ä¹‹é—´</li>
<li>pythonå¯¹è±¡å’Œæ•°æ®è¡¨ä¹‹é—´è½¬æ¢</li>
</ul>

<h6 id="toc_13">ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å‹å±‚</h6>

<ul>
<li>å±è”½ä¸åŒçš„æ•°æ®åº“ä¹‹é—´çš„å·®å¼‚</li>
<li>å¼€å‘è€…æ›´åŠ ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å¼€å‘</li>
<li>æä¾›å¾ˆå¤šä¾¿æ·å·¥å…·æœ‰åŠ©å¼€å‘</li>
</ul>

<h5 id="toc_14">åˆ›å»ºåšå®¢æ–‡ç« æ¨¡å‹</h5>

<h6 id="toc_15">è®¾è®¡æ’­å®¢æ–‡ç« æ¨¡å‹</h6>

<ul>
<li>æ–‡ç« æ ‡é¢˜â€”â€”æ–‡æœ¬ç±»å‹</li>
<li>æ–‡ç« æ‘˜è¦â€”â€”æ–‡æœ¬ç±»å‹</li>
<li>æ–‡ç« å†…å®¹â€”â€”æ–‡æœ¬ç±»å‹</li>
<li>å”¯ä¸€idæ ‡è®°â€”â€”intç±»å‹ï¼ˆè‡ªå¢ã€ä¸»é”®ï¼‰</li>
<li>å‘å¸ƒæ—¥æœŸâ€”â€”æ—¥æœŸç±»å‹</li>
</ul>

<h6 id="toc_16">æ¨¡å‹å±‚å¸¸ç”¨å­—æ®µ</h6>

<ul>
<li>æ•°å­—ç±»å‹ï¼š

<ul>
<li>IntegerField()#æ•´æ•° 11ä¸ªå­—èŠ‚</li>
<li>BigIntegerField()#æ•´æ•° 20ä¸ªå­—èŠ‚</li>
<li>PositiveIntegerField()#æ­£æ•´æ•° 10ä¸ªå­—èŠ‚</li>
<li>SmallIntegerField()#æ•´æ•° 6ä¸ªå­—èŠ‚</li>
<li>PositiveSmallIntegerField()#æ­£æ•´æ•° 5ä¸ªå­—èŠ‚</li>
</ul></li>
<li>æ–‡æœ¬ç±»å‹ï¼š

<ul>
<li>TextField()#longtext</li>
<li>CharField()#varchar</li>
<li>å¸ƒå°”ç±»å‹<br/></li>
<li>BooleanField()#å…è®¸ä¸ºç©º</li>
<li>NullBooleanField()#ä¸å…è®¸ä¸ºç©º</li>
</ul></li>
<li>æµ®ç‚¹å‹

<ul>
<li>FloatField()</li>
<li>DecimalField()#æŒ‡å®šæ•´æ•°å’Œå°æ•°å„å¤šå°‘ä½</li>
</ul></li>
<li>æ—¥æœŸç±»å‹ï¼š

<ul>
<li>DateTimeField()#å¹´æœˆæ—¥æ—¶åˆ†ç§’</li>
<li>DateField()# å¹´æœˆæ—¥</li>
<li>DurationField()#ä¸€æ®µæ—¶é—´ intç±»å‹</li>
</ul></li>
<li>è‡ªå¢IDï¼š 

<ul>
<li>AutoField()</li>
<li>BigAutoField()//æ¥å—æ›´å¤§çš„å€¼</li>
</ul></li>
<li>ä¸»é”®å®šä¹‰ï¼šprimary_keyå±æ€§</li>
<li><p>äºŒè¿›åˆ¶æ•°æ®</p>

<ul>
<li>BinaryField()</li>
</ul></li>
<li><p>å…¶ä»–ç±»å‹</p>

<ul>
<li>EmailField()#é‚®ç®±</li>
<li>ImageField()#å›¾ç‰‡</li>
<li>FileField()#æ–‡ä»¶</li>
<li>FilePathField()#æ–‡ä»¶è·¯å¾„</li>
<li>UrlField()</li>
<li>UUIDField()</li>
<li>GenericIPAddressField()#ipåœ°å€</li>
</ul></li>
</ul>

<h6 id="toc_17">æ¨¡å‹å±‚å…³ç³»å‹å­—æ®µ</h6>

<ul>
<li>ä¸€å¯¹ä¸€ï¼ˆOneToOneFieldï¼‰</li>
<li>å¤šå¯¹ä¸€(ForeignKey)</li>
<li>å¤šå¯¹å¤š(ManyToManyField)</li>
</ul>

<h6 id="toc_18">ç”Ÿæˆæ•°æ®è¡¨</h6>

<ol>
<li>å‘½ä»¤è¡Œè¿›å…¥åˆ°manage.pyåŒçº§ç›®å½•</li>
<li>æ‰§è¡Œpython3 manage.py makemigrations appnameï¼ˆå¯é€‰ï¼‰</li>
<li>æ‰§è¡Œpython3 manage.py migrate </li>
</ol>

<h6 id="toc_19">Demo</h6>

<ol>
<li>åœ¨åº”ç”¨çš„ models.py å®šä¹‰æ¨¡å‹</li>
</ol>

<pre><code>from django.db import models
# Create your models here.
class Aritcle(models.Model):
    
    aritcle_id = models.AutoField(primary_key=True)
    title = models.TextField()
    brief_content = models.TextField()
    content = models.TextField()
    publish_date = models.DateTimeField(auto_now=True)
    
    def __str__(self):
        return self.title

# æ¼”ç¤ºå…³ç³»å‹model      
class A(models.Model):
    onetoone = models.OneToOneField(Aritcle)

class B(models.Model):
    foreign = models.ForeignKey(A)

class C(models.Model):
    manytomany = models.ManyToManyField(B)
       
</code></pre>

<ol>
<li><p>ç„¶åè¿ç§»æ¨¡å‹å®šä¹‰åˆ°æ•°æ®åº“å½“ä¸­</p>

<ul>
<li>python3 manage.py makemigrations appname</li>
</ul>

<pre><code>Alexs-MacBook-Air:django_intrduction alexwee$ python3 manage.py makemigrations blog
Migrations for &#39;blog&#39;:
  blog/migrations/0001_initial.py
    - Create model Aritcle
</code></pre></li>
<li><p>è¿è¡Œè¿ç§»æ–‡ä»¶ æŠŠè¿ç§»æ–‡ä»¶çš„å†…å®¹åŒæ­¥åˆ°æ•°æ®åº“ä¸­</p>

<ul>
<li>python3 manage.py migrate appname</li>
</ul>

<pre><code>Alexs-MacBook-Air:django_intrduction alexwee$ python3 manage.py migrate  blog
Operations to perform:
Apply all migrations: blog
Running migrations:
Applying blog.0001_initial... OK
</code></pre></li>
</ol>

<h5 id="toc_20">Django shell</h5>

<p>Python shell ç”¨äºäº¤äº’å¼çš„pythonç¼–ç¨‹<br/>
Django shell ä¹Ÿç±»ä¼¼ç»§æ‰¿djangoé¡¹ç›®ç¯å¢ƒ</p>

<h6 id="toc_21">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨django shell</h6>

<ul>
<li>ä¸´æ—¶æ€§æ“ä½œä½¿ç”¨django shellæ›´åŠ æ–¹ä¾¿</li>
<li>å°èŒƒå›´çš„debugæ›´ç®€å•ï¼Œä¸éœ€è¦è¿è¡Œæ•´ä¸ªé¡¹ç›®æ¥æµ‹è¯•</li>
<li>æ–¹ä¾¿å¼€å‘ æ–¹ä¾¿è°ƒè¯• æ–¹ä¾¿debug</li>
</ul>

<h6 id="toc_22">demo</h6>

<p>ä½¿ç”¨django shell æ–°å»ºæ–‡ç« </p>

<ol>
<li><p><code>python3 manage.py shell</code>è¿›å…¥shell ç¯å¢ƒ</p>

<pre><code>Python 3.7.1 (v3.7.1:260ec2c36a, Oct 20 2018, 03:13:28) 
[Clang 6.0 (clang-600.0.57)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
(InteractiveConsole)
&gt;&gt;&gt; 
</code></pre></li>
<li><p>åœ¨shellç¯å¢ƒæ–°å»ºæ–‡ç« å¹¶ä¿å­˜åˆ°æ•°æ®åº“</p>

<pre><code class="language-&gt;&gt;&gt;">from blog.models import Aritcle
&gt;&gt;&gt; a = Aritcle()
&gt;&gt;&gt; a.title = &quot;test django shell&quot;
&gt;&gt;&gt; a.brief_content = &quot;test django shell by maweefeng&quot;
&gt;&gt;&gt; a.content = &quot;test django shell new ariticle main content&quot;
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; print(a)
Aritcle object (None)
&gt;&gt;&gt; a.save()//ä¿å­˜åˆ°æ•°æ®åº“
&gt;&gt;&gt; 
</code></pre></li>
<li><p>éªŒè¯æ–‡ç« æ˜¯å¦ä¿å­˜åˆ°æ•°æ®åº“</p>

<pre><code>&gt;&gt;&gt; ariticle = Aritcle.objects.all()//å–å‡ºæ‰€æœ‰æ–‡ç« 
&gt;&gt;&gt; aricle = ariticle[0]//å–åˆ°ç¬¬ä¸€ç¯‡æ–‡ç« 
&gt;&gt;&gt; print(aricle.title)
&lt;class &#39;django.db.models.fields.TextField&#39;&gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; print(aricle)
Aritcle object (1)
&gt;&gt;&gt; print(aricle.content)
&lt;class &#39;django.db.models.fields.TextField&#39;&gt;
&gt;&gt;&gt; 
</code></pre></li>
</ol>

<h5 id="toc_23">django adminæ¨¡å—</h5>

<h6 id="toc_24">django adminæ¨¡å—æ˜¯ä»€ä¹ˆ</h6>

<ul>
<li>æ˜¯ä¸€ä¸ªåå°ç®¡ç†å·¥å…·ï¼Œä¸éœ€è¦ç”¨æˆ·å¼€å‘åå°ç®¡ç†å·¥å…·</li>
<li>å¯ä»¥è¯»å–å®šä¹‰çš„æ¨¡å‹å…ƒæ•°æ®ï¼Œæä¾›å¼ºå¤§çš„ç®¡ç†ä½¿ç”¨é¡µé¢</li>
</ul>

<h6 id="toc_25">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨django adminæ¨¡å—</h6>

<ul>
<li>django shell æ–°å»ºæ–‡ç« å¤ªå¤æ‚äº†</li>
<li>ç®¡ç†é¡µé¢æ˜¯åŸºç¡€è®¾æ–½ä¸­é‡è¦çš„éƒ¨åˆ†</li>
<li>è®¤è¯ç”¨æˆ·ï¼Œæ˜¾ç¤ºç®¡ç†æ¨¡å‹ï¼Œæ ¡éªŒè¾“å…¥ç­‰åŠŸèƒ½ç±»ä¼¼</li>
</ul>

<h6 id="toc_26">ä½¿ç”¨æ–¹æ³•</h6>

<ul>
<li>åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
<code>python3 manage.py createsuperuser</code></li>
</ul>

<pre><code>* Alexs-MacBook-Air:django_intrduction alexwee$ python3 manage.py createsuperuser
Username (leave blank to use &#39;alexwee&#39;): maweefeng
address: 
Password: 
Password (again): 
Superuser created successfully.
Alexs-MacBook-Air:django_intrduction alexwee$ 
</code></pre>

<ul>
<li><p>ç™»é™†é¡µé¢è¿›è¡Œç®¡ç†</p>

<ul>
<li>é¡¹ç›®è·‘èµ·æ¥<code>python3 manage.py runserver</code></li>
<li>æµè§ˆå™¨è¾“å…¥ <a href="http://127.0.0.1:8000/admin">http://127.0.0.1:8000/admin</a> è¿›å…¥ç™»é™†é¡µé¢</li>
</ul>

<p><img src="media/15583189073141/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-05-21%20%E4%B8%8A%E5%8D%8811.13.25.png" alt="å±å¹•å¿«ç…§ 2019-05-21 ä¸Šåˆ11.13.25  " style="width:400px;"/></p>

<p><img src="media/15583189073141/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-05-21%20%E4%B8%8A%E5%8D%8811.13.55.png" alt="å±å¹•å¿«ç…§ 2019-05-21 ä¸Šåˆ11.13.55 " style="width:400px;"/></p></li>
</ul>

<p>ä½†æ˜¯æ²¡æœ‰çœ‹åˆ°åˆšæ‰æ–°å»ºçš„æ–‡ç« æ¨¡å‹ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰æŠŠæ¨¡å‹æ³¨å†Œåˆ°adminä¸­ï¼Œè¿›å…¥IDEä¸­çš„åº”ç”¨ç›®å½•ä¸‹çš„admin.py </p>

<pre><code>from django.contrib import admin

# Register your models here.

from .models import Aritcle

admin.site.register(Aritcle)  
</code></pre>

<p>å›åˆ°æµè§ˆå™¨åˆ·æ–° å°±æœ‰äº†æ–°çš„åˆ†ç»„</p>

<p><img src="media/15583189073141/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-05-21%20%E4%B8%8A%E5%8D%8811.20.06.png" alt="å±å¹•å¿«ç…§ 2019-05-21 ä¸Šåˆ11.20.06"/></p>

<h5 id="toc_27">å®ç°æ’­å®¢æ•°æ®è¿”å›é¡µé¢</h5>

<p>ç±»ä¼¼äºä¹‹å‰è¿”å›çš„helloworldé¡¹ç›®</p>

<ol>
<li><p>åº”ç”¨è§†å›¾ views.py</p>

<pre><code>from django.shortcuts import render
from django.http import HttpResponse
from blog.models import Summary
# Create your views here.
def hello_world(request):
    return HttpResponse(&quot;hello world&quot;)

def ariticle_content(request):
    summary = Summary.objects.all()[0]
    title = summary.summary_title
    content = summary.summary_content
    summary_id = summary.summary_id
    pubdate = summary.publish_date
    return_str = &#39;title:%s summary_content:%s summary_id:%s publicdate:%s&#39;%(title,content,summary_id,pubdate)

    return HttpResponse(return_str)
</code></pre></li>
<li><p>åº”ç”¨è·¯ç”± urls.py</p>

<pre><code>from django.urls import path,include
import blog.views

urlpatterns = [
    path(&quot;hello_world&quot;,blog.views.hello_world),
    path(&quot;content&quot;,blog.views.ariticle_content)
]
</code></pre></li>
<li><p>é¡¹ç›®è·¯ç”± urls.py</p>

<pre><code>from django.contrib import admin
from django.urls import path,include

urlpatterns = [
    path(&#39;admin/&#39;, admin.site.urls),
    path(&#39;blog/&#39;, include(&quot;blog.urls&quot;)),

]
</code></pre></li>
</ol>

<h2 id="toc_28">Djangoè§†å›¾ä¸æ¨¡æ¿</h2>

<h3 id="toc_29">ä½¿ç”¨Bootstrapå®ç°é™æ€åšå®¢é¡µé¢</h3>

<h4 id="toc_30">é¡µé¢å¸ƒå±€è®¾è®¡</h4>

<ul>
<li>åšå®¢é¦–é¡µ</li>
<li>æ–‡ç« è¯¦æƒ…é¡µ</li>
</ul>

<h4 id="toc_31">Bootstrap ä»¥åŠ Bootstrapçš„æ …æ ¼ç³»ç»Ÿ</h4>

<p>Bootstrapæ˜¯æ¥è‡ªç¾å›½twitterçš„å‰ç«¯æ¡†æ¶ï¼Œæä¾›éå¸¸å¤šçš„æ§ä»¶ä»¥åŠæºç ï¼Œæ …æ ¼ç³»ç»Ÿå°±æ˜¯æŠŠwebé¡µé¢åˆ†æˆå‡ ç­‰ä»½æ’åˆ—çš„æ–¹å¼ã€‚</p>

<h4 id="toc_32">åˆ›å»ºæ¨¡æ¿æ–‡ä»¶å¤¹å¹¶å®ç°é™æ€é¡µé¢</h4>

<p><strong>åœ¨åº”ç”¨æ–‡ä»¶å¤¹å†…éƒ¨æ–°å»ºæ–‡ä»¶å¤¹templatesï¼Œç„¶ååœ¨é‡Œé¢æ–°å»ºhtmlæ–‡ä»¶,è¿™æ˜¯å¾ˆå…³é”®çš„ä¸€æ­¥</strong></p>

<h5 id="toc_33">âš ï¸æ³¨æ„äº‹é¡¹</h5>

<p>è¿˜æœ‰éœ€è¦æ³¨æ„çš„æ˜¯æœ€å¥½åœ¨templatesæ–‡ä»¶å¤¹ä¸­å†æ–°å»ºåº”ç”¨åæ‰€å±çš„æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨åº”ç”¨åæ‰€å±çš„æ–‡ä»¶å¤¹ä¸­æ–°å»ºhtmlæ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºDjangoæŸ¥æ‰¾templatesæ˜¯æŒ‰ç…§INSTALLED_APPSä¸­çš„æ·»åŠ é¡ºåºæŸ¥æ‰¾templatsï¼Œæ‰€ä»¥ä¸åŒåº”ç”¨ä¸‹çš„templatesçš„htmlåŒåä¼šé€ æˆå†²çªã€‚</p>

<h3 id="toc_34">è®¤è¯†Djangoçš„æ¨¡ç‰ˆç³»ç»Ÿ</h3>

<p>pythonçš„è§†å›¾æ–‡ä»¶ä¸é€‚åˆç¼–ç htmlï¼Œå› ä¸ºé¡µé¢è®¾è®¡æ”¹å˜éœ€è¦ä¿®æ”¹pythonä»£ç ï¼Œæ¯”è¾ƒå¤æ‚ã€‚å¦å¤–ç½‘é¡µçš„é€»è¾‘å’Œè§†å›¾åº”è¯¥åˆ†å¼€è®¾è®¡ã€‚</p>

<p>æ¨¡ç‰ˆç³»ç»Ÿçš„è¡¨ç°å½¢å¼æ˜¯æ–‡æœ¬ï¼Œåˆ†ç¦»æ–‡æ¡£çš„è¡¨ç°å½¢å¼å’Œè¡¨ç°å†…å®¹ï¼Œæ¨¡ç‰ˆç³»ç»Ÿå®šä¹‰äº†ç‰¹æœ‰çš„æ ‡ç­¾å ä½ç¬¦ã€‚</p>

<p><strong>å­¦ä¹ æ¨¡ç‰ˆç³»ç»Ÿçš„åŸºæœ¬è¯­æ³•</strong></p>

<ol>
<li>å˜é‡æ ‡ç­¾ï¼š{{å˜é‡}}</li>
<li><p>forå¾ªç¯æ ‡ç­¾ï¼š{% for x in list %},{% endfor %}     </p>

<pre><code>  &lt;ul&gt;
    {% for item in list%}
    &lt;li&gt;{{item}}&lt;/li&gt;
    {% endfor%}
    &lt;/ul&gt;
</code></pre></li>
<li><p>if-elseæ ‡ç­¾ï¼š{% if %},{% else %},{%endif%}</p>

<pre><code> {% if true %}
        &lt;p&gt;it is true part&lt;/p&gt;
    {%else%}
        &lt;p&gt;it is false part&lt;/p&gt;
    {% endif %}
</code></pre></li>
</ol>

<h3 id="toc_35">ä½¿ç”¨æ¨¡ç‰ˆç³»ç»Ÿæ¸²æŸ“åšå®¢é¡µé¢</h3>

<p>renderæ¸²æŸ“å‡½æ•°</p>

<ul>
<li>render() å‡½æ•°ä¸­æ”¯æŒä¸€ä¸ªdictç±»å‹çš„å‚æ•°</li>
<li>è¯¥å­—å…¸æ˜¯åå°ä¼ é€’åˆ°æ¨¡æ¿çš„å‚æ•°ï¼Œé”®ä¸ºå‚æ•°å</li>
<li><p>åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨{{å‚æ•°å}}æ¥ç›´æ¥ä½¿ç”¨</p>

<pre><code>def render(request, template_name, context=None, content_type=None, status=None, using=None)

Return a HttpResponse whose content is filled with the result of calling django.template.loader.render_to_string() with the passed arguments.
</code></pre></li>
</ul>

<p>ç¼–å†™djangoåº”ç”¨çš„views.py </p>

<pre><code>from django.shortcuts import render
from django.http import HttpResponse
from blog.models import Summary,Article
    
def get_index_page(request):
    all_ariticle = Summary.objects.all()
    return render(request,&#39;blog/index.html&#39;,{&#39;aritcle_list&#39;:all_ariticle})

</code></pre>

<h3 id="toc_36">å®ç°æ–‡ç« è¯¦æƒ…é¡µé¢è·³è½¬</h3>

<h4 id="toc_37">Djangoä¸­çš„è¶…é“¾æ¥</h4>

<h5 id="toc_38">1âƒ£ï¸ ç›´æ¥æ‹¼æ¥</h5>

<p>ç›´æ¥åœ¨aæ ‡ç­¾çš„hrefä¸­æ‹¼æ¥éœ€è¦ç‚¹å‡»è·³è½¬çš„è·¯å¾„ åœ¨htmlçš„è¡¨ç°å½¢å¼ä¸º</p>

<pre><code>&lt;a href=&quot;/blog/detail/{{item.summary_id}}&quot;&gt;&lt;/a&gt;
</code></pre>

<h5 id="toc_39">2âƒ£ï¸ å‚æ•°ä»¥åŠå‘½åç©ºé—´</h5>

<ul>
<li>hrefåé¢æ˜¯ç›®æ ‡åœ°å€</li>
<li>templatesä¸­å¯ä»¥ç”¨<code>&quot;{% url &#39;app_name:url_name&#39; param%}&quot;</code></li>
<li>å…¶ä¸­app_name å’Œ url_nameéƒ½åœ¨urlä¸­é…ç½®ã€‚</li>
</ul>

<h6 id="toc_40">urlå‡½æ•°çš„åç§°å‚æ•°</h6>

<ul>
<li>é¡¹ç›®urls.py å†™åœ¨includeï¼ˆï¼‰çš„ç¬¬äºŒä¸ªå‚æ•°ä½ç½®ï¼Œnamespace=&#39;blog&#39;ï¼Œè¿˜è¦åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­ä¼ å…¥ä¸€ä¸ªåŒ…å«appnameçš„å…ƒç»„ è§ä¸‹é¢demo</li>
<li>åº”ç”¨ä¸‹åˆ™å†™åœ¨url()çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä½ç½®ï¼Œå†™ä¸Šname=â€˜æ–¹æ³•åâ€™</li>
<li>ä¸»è¦å–å†³äºæ˜¯å¦ä½¿ç”¨includeå¼•ç”¨äº†å¦ä¸€ä¸ªurlé…ç½®æ–‡ä»¶</li>
</ul>

<h6 id="toc_41">Demo</h6>

<ul>
<li><p>djangoé¡¹ç›®çš„urls.py </p>

<pre><code>  from django.contrib import admin
from django.urls import path,include

urlpatterns = [
    path(&#39;admin/&#39;, admin.site.urls),
    path(&#39;blog/&#39;, include((&quot;blog.urls&quot;,&#39;blog&#39;),namespace=&#39;blog&#39;)),  
]
</code></pre></li>
<li><p>djangoåº”ç”¨çš„urls.py </p>

<pre><code>from django.urls import path,include
import blog.views

urlpatterns = [
    path(&quot;hello_world&quot;,blog.views.hello_world),
    path(&quot;index&quot;,blog.views.get_index_summary_page),
    path(&quot;detail/&lt;int:article_id&gt;&quot;,blog.views.get_index_page,name=&#39;get_index_page&#39;)

]
</code></pre></li>
<li><p>djangoåº”ç”¨çš„views.py </p>

<pre><code>def get_detail_page(request,summary_id):
    all_ariticle = Summary.objects.all()
    cur_article = None
    for aritcle in all_ariticle:
        if aritcle.summary_id == summary_id:
            cur_article = aritcle
            break

    sectionList = cur_article.summary_content.split(&#39;\n&#39;)
return render(request,&#39;blog/detail.html&#39;,{&#39;curr_aritcle&#39;:cur_article,&#39;section_list&#39;:sectionList})
</code></pre></li>
<li><p>htmlè¶…é“¾æ¥éƒ¨åˆ†ä»£ç å†™æ³•</p>

<pre><code> &lt;a href=&quot;{% url &#39;blog:get_detail_page&#39; item.summary_id %}&quot;&gt;&lt;/a&gt;
</code></pre></li>
</ul>

<h3 id="toc_42">å®ç°åˆ†é¡µåŠŸèƒ½</h3>

<p>å‚æ•°requeståŒ…å«äº†ä¸€äº›getä»¥åŠpostçš„ä¿¡æ¯ã€‚</p>

<ul>
<li><p>djangoåº”ç”¨çš„views.py </p>

<pre><code>def get_index_page(request):
    # é€‚ç”¨ä¸/index?page=1ä¹‹ç±»çš„ç½‘ç»œè¯·æ±‚
    page = request.GET.get(&#39;page&#39;)
    if page:
        page = int(page)
    else:
        page = 1

    all_ariticle = Summary.objects.all()
    return render(request,&#39;blog/index.html&#39;,{&#39;aritcle_list&#39;:all_ariticle})
</code></pre></li>
</ul>

<h4 id="toc_43">djangoåˆ†é¡µç»„ä»¶Paginator</h4>

<ul>
<li><p>åœ¨views.pyä¸­å¼•å…¥åˆ†é¡µç»„ä»¶</p>

<pre><code>from django.core.paginator import Paginator
def get_index_page(request):
    # é€‚ç”¨ä¸/index?page=1ä¹‹ç±»çš„ç½‘ç»œè¯·æ±‚
    page = request.GET.get(&#39;page&#39;)
    if page:
        page = int(page)
    else:
        page = 1

    all_ariticle = Summary.objects.all()
    paginator = paginator(all_ariticle,3)
    page_aritcle_list = paginator.page(page)
    page_num = paginator.num_pages
    if page_aritcle_list.has_next():
        next_page = page + 1
    else:
        next_page = page

    if page_aritcle_list.has_previous():
        previous_page = page - 1
    else:
        previous_page = page

    return render(request,&#39;blog/index.html&#39;,{
        &#39;aritcle_list&#39;:page_aritcle_list,
        &#39;page_num&#39;:range(1,page_num+1),
        &quot;curr_page&quot;:page,
        &#39;next_page&#39;:next_page,
        &#39;previous_page&#39;:previous_page
        }
        )

</code></pre></li>
</ul>

<h2 id="toc_44">è¡¥å……éƒ¨åˆ† ORM</h2>

<p>ORM</p>

<ul>
<li>å¯¹è±¡å…³ç³»æ˜ å°„(object relation mapping)</li>
<li>å®ç°äº†å¯¹è±¡å’Œæ•°æ®åº“ä¹‹é—´çš„æ˜ å°„</li>
<li>éšè—äº†æ•°æ®è®¿é—®çš„ç»†èŠ‚ï¼Œä¸éœ€è¦ç¼–å†™sqlè¯­å¥</li>
</ul>

<h3 id="toc_45">å¦‚ä½•åˆ é™¤ä¸€ä¸ªæ¨¡å‹ç±»</h3>

<ol>
<li>é¦–å…ˆåˆ é™¤models.pyä¸­æ¨¡å‹ç±»çš„ä»£ç </li>
<li>åˆ é™¤æ¨¡å‹ç±»åœ¨migrationsæ–‡ä»¶å¤¹ä¸­å¯¹åº”çš„æ–‡ä»¶</li>
<li>åˆ é™¤django_migrationsä¸­å¯¹åº”çš„ç”Ÿæˆè®°å½•</li>
<li>å†åˆ é™¤æ¨¡å‹å¯¹åº”çš„æ•°æ®è¡¨ </li>
</ol>

<p>åˆ‡è®°ä¸è¦ç›´æ¥æŠŠæ•°æ®åº“æ•´ä¸ªåˆ æ‰å†ç”Ÿæˆï¼Œå°¤å…¶æ˜¯å½“æ•°æ®åº“ä¸­æœ‰æ•°æ®çš„æ—¶å€™ã€‚</p>

<h3 id="toc_46">å¦‚ä½•å¯¼å…¥æ•°æ®</h3>

<ol>
<li><p>django shell</p>

<pre><code class="language-&gt;&gt;&gt;">from blog.models import Aritcle
&gt;&gt;&gt; a = Aritcle()
&gt;&gt;&gt; a.title = &quot;test django shell&quot;
&gt;&gt;&gt; a.brief_content = &quot;test django shell by maweefeng&quot;
&gt;&gt;&gt; a.content = &quot;test django shell new ariticle main content&quot;
&gt;&gt;&gt; a.save()//ä¿å­˜åˆ°æ•°æ®åº“
</code></pre></li>
<li><p>è„šæœ¬æ‰¹é‡å¯¼å…¥</p>

<pre><code>import os
import sys
import random
import django
from datetime import date

# åœ¨å½“å‰é¡¹ç›®ä¸­è¿è¡Œè¯¥pythonè„šæœ¬
project_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(project_path)
os.environ[&#39;DJANGO_SETTINGS_MODULE&#39;] = &#39;Django_ORM.settings&#39;
django.setup() 

from orm.models import Aritcle
#ä¸Šé¢è¿™è¡Œå¿…é¡»åœ¨django.setup()ä¹‹å

def import_data():

    for i in [1,2,3,4,5,6,7,8,9,10]:
         Aritcle.objects.create(title = &#39;è¿™ä¸ªæ˜¯æ ‡é¢˜%s&#39;%(i),brief_content=&#39;è¿™ä¸ªæ˜¯ç®€ä»‹&#39;,content=&#39;è¿™ä¸ªæ˜¯å†…å®¹æˆ‘ä»¬éƒ½æœ‰ä¸€ä¸ªå®¶åå­—å«ä¸­å›½&#39;)
    return True

if __name__ == &quot;__main__&quot;:
    if import_data():
        print(&#39;æ’å…¥æ•°æ®æˆåŠŸ&#39;)

</code></pre></li>
<li><p>fixtures <br/>
ä½¿ç”¨django serialization ç”Ÿæˆ model</p>

<ul>
<li><p>ç»ˆç«¯å‘½ä»¤å¯¼å‡ºæ•°æ®<code>python3 manage.py dumpdata &gt;  orm.json</code>ç”Ÿæˆäº†ä¸€ä¸ªjsonæ–‡ä»¶</p></li>
<li><p>ç„¶åä»æ•°æ®åº“ä¸­åˆ é™¤éƒ¨åˆ†æ•°æ®  </p></li>
<li><p>æ‰§è¡Œå‘½ä»¤ä»jsonä¸­å¯¼å…¥æ•°æ® <code>python3 manage.py loaddata  orm.json</code>  </p></li>
<li><p>æ•°æ®åº“ä¸­é‡æ–°å‡ºç°äº†åˆšæ‰åˆ é™¤çš„æ•°æ®ï¼ˆå› ä¸ºä»jsonä¸­é‡æ–°å¯¼å…¥äº†æ•°æ®ï¼‰ </p></li>
</ul></li>
<li><p>æ•°æ®åº“å±‚é¢çš„å¯¼å…¥æ•°æ®</p></li>
</ol>

<h3 id="toc_47">å¦‚ä½•å¯¼å‡ºæ•°æ®</h3>

<ol>
<li><p>å¯¼å‡ºfixturesèƒ½è¯†åˆ«çš„jsonæ–‡ä»¶</p>

<ul>
<li>ç»ˆç«¯å‘½ä»¤å¯¼å‡ºæ•°æ®<code>python3 manage.py dumpdata &gt;  orm.json</code>ç”Ÿæˆäº†ä¸€ä¸ªjsonæ–‡ä»¶</li>
</ul></li>
<li><p>å¯¼å‡ºå…¶ä»–æ ¼å¼çš„æ–‡ä»¶<br/>
pcharmè‡ªå¸¦çš„æ•°æ®åº“å·¥å…·ï¼Œå•é€‰æŸä¸ªè¡¨å³é”®dump data to file<br/>
nivacate datumç­‰æ•°æ®åº“å·¥å…·å¯¼å‡ºæ•°æ®<br/>
<img src="https://ws3.sinaimg.cn/large/006tNc79gy1g3b37uxg9aj31740p945u.jpg" alt=""/></p></li>
<li><p>æ•°æ®åº“å±‚é¢çš„å¯¼å‡ºæ•°æ®</p></li>
</ol>

<h3 id="toc_48">ModelsAPI</h3>

<h4 id="toc_49">æŸ¥è¯¢é›†ä»‹ç»</h4>

<ol>
<li><p>æŸ¥è¯¢ è¿‡æ»¤ æ£€ç´¢</p>

<pre><code>Aritcle.objects.all()#è¿”å›æ‰€æœ‰ç»“æœ
Aritcle.objects.get(title=&#39;è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜&#39;)#è¿”å›ä¸€ä¸ªç»“æœ å¤šæ¡åˆ™ä¼šæŠ¥é”™
Aritcle.objects.filter(star__gte = 500)#querysetå¯ä»¥æ˜¯å¤šæ¡ç»“æœ fans &gt;=500çš„ç»“æœ
</code></pre></li>
<li><p>å­—æ®µæ•°æ®åŒ¹é… å¤§å°å†™æ•æ„Ÿ</p>

<pre><code>teacher = Aritcle.objects.filter(star__in=[555,1231])
teacher = Aritcle.objects.filter(title__contains=&#39;a&#39;)
</code></pre></li>
<li><p>ç»“æœåˆ‡ç‰‡ æ’åº é“¾å¼æŸ¥è¯¢</p>

<pre><code>Aritcle.objects.all()[:1]
Aritcle.objects.all().order_by(&#39;star&#39;)#å‡åºæ’åº
Aritcle.objects.all().order_by(&#39;-star&#39;)#é™åºæ’åº
Aritcle.objects.filter(star__gte = 500).order_by(&#39;-star&#39;)#é“¾å¼æŸ¥è¯¢
</code></pre></li>
<li><p>æŸ¥çœ‹æ‰§è¡Œçš„åŸç”ŸSQL xxx.query</p>

<pre><code>print(str(Aritcle.objects.filter(star__gte = 500).order_by(&#39;-star&#39;).query))
</code></pre></li>
</ol>

<h4 id="toc_50">è¿”å›æ–°çš„QuerySetçš„API</h4>

<ol>
<li><p>all() filter() order_by() exclude()å»æ‰æŸä¸ªmodel reverse()åè½¬ distinct()å»é‡</p>

<pre><code>Aritcle.objects.all().exclude(title = &#39;title&#39;)
Aritcle.objects.all().exclude(title = &#39;title&#39;).reverse()
</code></pre></li>
<li><p>extra() defer() only() å®ç°å­—æ®µåˆ«å æ’é™¤ä¸€äº›å­—æ®µ é€‰æ‹©ä¸€äº›å­—æ®µ</p>

<pre><code>Aritcle.objects.all().extra(select={&#39;article_title&#39;=&#39;title&#39;})
Aritcle.objects.all().only(&#39;title&#39;,&#39;star&#39;).query()
</code></pre></li>
<li><p>dates() datetimes() æ ¹æ®æ—¶é—´æ—¥æœŸè·å–æŸ¥è¯¢é›†</p>

<pre><code>Aritcle.objects.dates(&#39;publish_date&#39;,&#39;month&#39;,order =&#39;DESC&#39;)
</code></pre></li>
<li><p>union() intersection() difference() å¹¶é›† äº¤é›† å·®é›†</p>

<pre><code>a_500 = Aritcle.objects.filter(star__gte = 500)
a_200 = Aritcle.objects.filter(star__lte = 200)
print(a_500.union(a_200))
print(a_500.intersection(a_200))
print(a_500.difference(a_200))

</code></pre></li>
<li><p>select_related() ä¸€å¯¹ä¸€ å¤šå¯¹ä¸€æŸ¥è¯¢ä¼˜åŒ– prefetch_related() ä¸€å¯¹å¤š å¤šå¯¹å¤šæŸ¥è¯¢ä¼˜åŒ– åå‘æŸ¥è¯¢</p>

<pre><code>Aritcle.objects.all().select_related(&#39;author&#39;)
Audiences.objects.filter(star__gte = 500).prefetch_related(&#39;article&#39;)

</code></pre></li>
<li><p>annotate() ä½¿ç”¨èšåˆè®¡æ•° æ±‚å’Œ å¹³å‡æ•° raw()æ‰§è¡ŒåŸå£°sql</p>

<pre><code># å¯¹æ¯ä¸ªæ–‡ç« å…³è”çš„ä½œè€…çš„è¯„ğŸŒŸè¿›è¡Œç»Ÿè®¡
Aritcle.objects.values(&#39;author&#39;).annotate(vol=Sum(&#39;star&#39;))
# vol star æ€»å’Œ 
Aritcle.objects.values(&#39;author&#39;).annotate(ave=Avg(&#39;star&#39;))
# ave star æ±‚å¹³å‡å€¼ 
</code></pre></li>
<li><p>values() values_list() è·å–å­—å…¸æˆ–è€…å…ƒç¥–å½¢å¼çš„queryset</p>

<pre><code>Aritcle.objects.values(&#39;title&#39;,&#39;star&#39;)
Aritcle.objects.values_list(&#39;title&#39;,&#39;star&#39;)
</code></pre></li>
</ol>

<h4 id="toc_51">ä¸è¿”å›QuerySetçš„API</h4>

<ol>
<li><p>è·å–å¯¹è±¡ get()è·å–å•ä¸ªå¯¹è±¡ get_or_create()è·å–æˆ–è€…åˆ›å»º first() last() latest() earliest() in_bulk()</p></li>
<li><p>åˆ›å»ºå¯¹è±¡ create() bulk_create() create_or_update() åˆ›å»º æ‰¹é‡åˆ›å»º åˆ›å»ºæˆ–æ›´æ–°</p></li>
<li><p>æ›´æ–°å¯¹è±¡ update()  update_or_create()æ›´æ–° æ›´æ–°æˆ–åˆ›å»º</p>

<pre><code>Aritcle.objects.filter(star__gte = 500).update(star=20)
</code></pre></li>
<li><p>åˆ é™¤å¯¹è±¡delete() ä½¿ç”¨filterè¿‡æ»¤</p>

<pre><code>Aritcle.objects.filter(star__gte = 500).delete()
</code></pre></li>
<li><p>å…¶ä»–æ“ä½œexists() count() aggregate()åˆ¤æ–­æ˜¯å¦å­˜åœ¨ ç»Ÿè®¡ä¸ªæ•° èšåˆ </p>

<pre><code>Aritcle.objects.filter(star = 500).exists()
Aritcle.objects.count()
Aritcle.objects.aggregate(Max(&#39;star&#39;,Min(&#39;star&#39;),Avg(&#39;star&#39;)))
</code></pre></li>
</ol>

<h4 id="toc_52">è‡ªå®šä¹‰èšåˆæŸ¥è¯¢ å®ç°group_concat</h4>

<p>åœ¨models.py ä¸­è‡ªå®šä¹‰ç»§æ‰¿è‡ªmodels.Aggregate çš„ç±»GroupConcat</p>

<pre><code>class GroupConcat(models.Aggregate):
    function = &#39;Group_Concat&#39;
    template = &#39;%(fuction)s(%(distinct)s%(expressions)s%(ordering)s%(separator)s)&#39;

    def __init__(self,expression,distinct=False,ordering=None,separator=&#39;,&#39;,**extra):
        super(GroupConcat,self).__init__(expression,
        distinct=&#39;DISTINCT&#39; if distinct else &#39;&#39;,
        ordering = &#39;ORDER BY %s&#39; % ordering if ordering is not None else &#39;&#39;,
        separator = &#39;SEPARATOR &quot;%s&quot;&#39;%separator,
        output_field=models.CharField(),**extra)


</code></pre>

<p>views.py</p>

<pre><code>Aritcle.objects.values(&#39;author&#39;).annotate(title=GroupConcat(&#39;title&#39;,distinct=True,ordering=&#39;title ASC&#39;,separator=&#39;-&#39;))
</code></pre>




      </div>

      <div class="row">
        <div class="large-6 columns">
          <p class="text-left" style="padding:15px 0px;">
            
          </p>
        </div>
        <div class="large-6 columns">
          <p class="text-right" style="padding:15px 0px;">
            
            <a href="15578899295258.html" title="Next Post: PromiseKit">PromiseKit
              &raquo;</a>
            
          </p>
        </div>
      </div>
      <div class="comments-wrap">
        <div class="share-comments">
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5bfe6ae3f692f811"></script>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://maweefeng.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//maweefeng.disqus.com/count.js" async></script>

          

          
        </div>
      </div>
    </div><!-- article-wrap -->
  </div><!-- large 8 --> <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="/asset/img/logo.png" /></div>
            
                <h1>Code Log ğŸ‘¨â€ğŸ’»â€ </h1>
                <div class="site-des"></div>
                <div class="social">









<a target="_blank" class="github" target="_blank" href="https://github.com/maweefeng" title="GitHub">GitHub</a>
<a target="_blank" class="email" href="mailto:maweefeng@gmail.com" title="Email">Email</a>
  <!-- <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a> -->
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="iOS.html"><strong>iOS</strong></a>
        
            <a href="Git.html"><strong>Git</strong></a>
        
            <a href="CocoaPods.html"><strong>CocoaPods</strong></a>
        
            <a href="Django.html"><strong>Django</strong></a>
        
            <a href="about.html"><strong>about</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="15583189073141.html">Djangoå…¥é—¨ â€” å»ºç«‹ç®€æ˜“åšå®¢ä»¥åŠORMå…³ç³»ä»‹ç»</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15578899295258.html">PromiseKit</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15572343607934.html">RunLoop</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15554977521883.html">Swiftå•ä¾‹å†™æ³•</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15554962348970.html">Filter, Map, Reduce  Functions</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <!-- <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p> -->
<p class="copyright">æ—¥å…‰ä¹‹ä¸‹ æ°¸æ— æ–°äº‹</p>
</div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
