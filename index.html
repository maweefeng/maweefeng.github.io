<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>
    
    Code Log ğŸ‘¨â€ğŸ’»â€ 
    
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="Code Log ğŸ‘¨â€ğŸ’»â€ " type="application/atom+xml">
  <link rel="stylesheet" href="asset/css/foundation.min.css" />
  <link rel="stylesheet" href="asset/css/docs.css" />
  <script src="asset/js/vendor/modernizr.js"></script>
  <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>
    hljs.initHighlightingOnLoad();

    window.onload = function () {

      var footerPath = window.location.pathname.split('/')[window.location.pathname.split('/').length - 1];
      if (footerPath == 'archives.html') {
        // alert('åˆ†ç±»');
        document.getElementById('main-menu').getElementsByTagName("li")[1].className = "is_active";

      } else if (footerPath == 'about.html') {
        document.getElementById('main-menu').getElementsByTagName("li")[2].className = "is_active";

        // alert('å…³äºæˆ‘');
  
      } else {
        // alert('é¦–é¡µ');
        document.getElementById('main-menu').getElementsByTagName("li")[0].className = "is_active";
      }


    }
  </script>
  <script type="text/javascript">
    function before_search() {
      var searchVal = 'site: ' + document.getElementById('search_input').value;
      document.getElementById('search_q').value = searchVal;
      return true;
    }
  </script>
</head>

<body class="antialiased hide-extras">

  <div class="marketing off-canvas-wrap" data-offcanvas>
    <div class="inner-wrap">


      <nav class="top-bar docs-bar hide-for-small" data-topbar>


        <section class="top-bar-section">
          <div class="row">
            <div style="position: relative;width:100%;">
              <div style="position: absolute; width:100%;">
                <ul id="main-menu" class="left">
                  
                  <li id=""><a id="" target="_self" href="index.html">Home</a></li>
                  
                  <li id=""><a id="" target="_self" href="archives.html">Archives</a></li>
                  
                  <li id=""><a id="" target="_self" href="about.html">About</a></li>
                  
                </ul>

                <ul class="right" id="search-wrap">
                  <li>
                    <form target="_blank" onsubmit="return before_search();" action="http://google.com/search" method="get">
                      <input type="hidden" id="search_q" name="q" value="" />
                      <input tabindex="1" type="search" id="search_input" placeholder="Search" />
                    </form>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </section>

      </nav>

      <nav class="tab-bar show-for-small">
        <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
          <span> &nbsp; Code Log ğŸ‘¨â€ğŸ’»â€ </span>
        </a>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">

          <li><a href="index.html">Home</a></li>
          <li><a href="archives.html">Archives</a></li>
          
          <li><label>Categories</label></li>

          
          <li id="iOS"><a href="iOS.html">iOS</a></li>
          
          <li id="Git"><a href="Git.html">Git</a></li>
          
          <li id="CocoaPods"><a href="CocoaPods.html">CocoaPods</a></li>
          
          <li id="Django"><a href="Django.html">Django</a></li>
          
          <li id="Spiders"><a href="Spiders.html">Spiders</a></li>
          
          <li id="about"><a href="about.html">about</a></li>
          

        </ul>
      </aside>

      <a class="exit-off-canvas" href="#"></a>


      <section id="main-content" role="main" class="scroll-container"> <script type="text/javascript">
	$(function(){
		$('#menu_item_index').addClass('is_active');
	});
</script>
<div class="row">
	<div class="large-8 medium-8 columns">
		<div class="markdown-body home-categories">
		
			<div class="article">
                <a class="clearlink" href="15590976892074.html">
                
                  <h1>Scrapy æŠ“å–ç½‘é¡µæ•°æ®</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2 id="toc_0">Scrapy ä»‹ç»</h2>

<p>Scrapyï¼ŒPythonå¼€å‘çš„ä¸€ä¸ªå¿«é€Ÿã€é«˜å±‚æ¬¡çš„å±å¹•æŠ“å–å’ŒwebæŠ“å–æ¡†æ¶ï¼Œç”¨äºæŠ“å–webç«™ç‚¹å¹¶ä»é¡µé¢ä¸­æå–ç»“æ„åŒ–çš„æ•°æ®ã€‚Scrapyç”¨é€”å¹¿æ³›ï¼Œå¯ä»¥ç”¨äºæ•°æ®æŒ–æ˜ã€ç›‘æµ‹å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚<br/>
Scrapyå¸å¼•äººçš„åœ°æ–¹åœ¨äºå®ƒæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥æ ¹æ®éœ€æ±‚æ–¹ä¾¿çš„ä¿®æ”¹ã€‚å®ƒä¹Ÿæä¾›äº†å¤šç§ç±»å‹çˆ¬è™«çš„åŸºç±»ï¼Œå¦‚BaseSpiderã€sitemapçˆ¬è™«ç­‰ï¼Œæœ€æ–°ç‰ˆæœ¬åˆæä¾›äº†web2.0çˆ¬è™«çš„æ”¯æŒã€‚<br/>
Scrapï¼Œæ˜¯ç¢ç‰‡çš„æ„æ€ï¼Œè¿™ä¸ªPythonçš„çˆ¬è™«æ¡†æ¶å«Scrapyã€‚</p>

<p>é¦–å…ˆå¿…é¡»æœ‰pythonçš„ç¯å¢ƒï¼Œå¦‚æœæ²¡æœ‰çš„è¯éœ€è¦å®‰è£…ï¼Œç›®å‰python2.xå·²ç»ä¸å†æ›´æ–°ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯python3çš„ç¯å¢ƒã€‚</p>

<p>å¦‚æœä½ å·²ç»æœ‰äº†python3çš„ç¯å¢ƒå¹¶ä¸”å·²ç»å®‰è£…äº†pip3ï¼Œé‚£ä¹ˆå®‰è£…scrapyåªéœ€è¦ä¸€è¡Œå‘½ä»¤å³å¯ã€‚</p>

<pre><code>pip3 install scrapy
</code></pre>

<p>å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…pip3çš„è¯ï¼Œå»ºè®®å…ˆå®‰è£…pip3è¿›è¡ŒåŒ…ç®¡ç†ã€‚</p>

<h2 id="toc_1">pip3</h2>

<p>pip æ˜¯ Python åŒ…ç®¡ç†å·¥å…·ï¼Œè¯¥å·¥å…·æä¾›äº†å¯¹Python åŒ…çš„æŸ¥æ‰¾ã€ä¸‹è½½ã€å®‰è£…ã€å¸è½½çš„åŠŸèƒ½ã€‚<br/>
Python 2.7.9 + æˆ– Python 3.4+ ä»¥ä¸Šç‰ˆæœ¬éƒ½è‡ªå¸¦ pip å·¥å…·ã€‚<br/>
ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥åˆ¤æ–­æ˜¯å¦å·²å®‰è£…ï¼š</p>

<pre><code>pip --version
</code></pre>

<p>å¦‚æœä½ è¿˜æœªå®‰è£…ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¥å®‰è£…ï¼š</p>

<pre><code>$ curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py   # ä¸‹è½½å®‰è£…è„šæœ¬
$ sudo python get-pip.py    # è¿è¡Œå®‰è£…è„šæœ¬
</code></pre>

<p>æ³¨æ„ï¼šç”¨å“ªä¸ªç‰ˆæœ¬çš„ Python è¿è¡Œå®‰è£…è„šæœ¬ï¼Œpip å°±è¢«å…³è”åˆ°å“ªä¸ªç‰ˆæœ¬ï¼Œå¦‚æœæ˜¯ Python3 åˆ™æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>

<pre><code>$ sudo python3 get-pip.py    # è¿è¡Œå®‰è£…è„šæœ¬ã€‚
</code></pre>

<p>ä¸€èˆ¬æƒ…å†µ pip å¯¹åº”çš„æ˜¯ Python 2.7ï¼Œpip3 å¯¹åº”çš„æ˜¯ Python 3.xã€‚</p>

<pre><code>&gt;&gt;&gt;pip3  -h#æŸ¥çœ‹pip3çš„å‘½ä»¤
Commands:
  install                     Install packages.
  download                    Download packages.
  uninstall                   Uninstall packages.
  freeze                      Output installed packages in requirements format.
  list                        List installed packages.
  show                        Show information about installed packages.
  check                       Verify installed packages have compatible dependencies.
  config                      Manage local and global configuration.
  search                      Search PyPI for packages.
  wheel                       Build wheels from your requirements.
  hash                        Compute hashes of package archives.
  completion                  A helper command used for command completion.
  help                        Show help for commands.
</code></pre>

<p>æ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯installï¼Œlistï¼Œä¸€ä¸ªæ˜¯å®‰è£…æŸä¸ªæ¡†æ¶ï¼Œå¦ä¸€ä¸ªæ˜¯åˆ—å‡ºæ‰€æœ‰å®‰è£…çš„pythonæ¡†æ¶ã€‚</p>

<h2 id="toc_2">demo æŠ“å–è±†ç“£å‰250åçš„ç”µå½±</h2>

<h3 id="toc_3">æ–°å»ºscrapyé¡¹ç›®</h3>

<ol>
<li>scrapy startproject é¡¹ç›®åç§°</li>
<li>cd è¿›å…¥åˆ°é¡¹ç›®åç§° </li>
<li>cd è¿›å…¥åˆ° spiders</li>
<li>scrapy genspider xxx_spider åŸŸå #ç”Ÿæˆçˆ¬è™«ç±»

<ul>
<li>æ¯”å¦‚scrapy genspider douban_spider movie.douban.com</li>
</ul></li>
</ol>

<p>é¡¹ç›®ç›®å½•å¦‚ä¸‹</p>

<ul>
<li>douban

<ul>
<li>spiders

<ul>
<li>douban_spider.py #æœ€é‡è¦çš„çˆ¬è™«ç±»</li>
</ul></li>
<li>items.py #çˆ¬å–çš„modelç±»</li>
<li>middlewares.py #ä¸­é—´ä»¶ ä¼ªè£…useragentæˆ–è€…è®¾ç½®ä»£ç†</li>
<li>pipelines.py #ç®¡é“ç±» æ•°æ®åŒæ­¥ </li>
<li>settings.py #è®¾ç½®ç±» é‡Œé¢æœ‰ä¸€äº›é¡¹ç›®çš„é…ç½®</li>
</ul></li>
</ul>

<h3 id="toc_4">è¿è¡Œé¡¹ç›®</h3>

<p>æœ‰ä¸¤ç§æ–¹æ³•</p>

<ol>
<li>æ‰“å¼€å‘½ä»¤è¡Œå·¥å…· <code>scrapy crawl xxx_spider</code></li>
<li><p>å»ºè®®ä½¿ç”¨scrapyçš„cmdlineå·¥å…·</p>

<ul>
<li><p>åœ¨spidersæ–‡ä»¶å¤¹ä¸‹æ–°å»ºå…¥å£main.py </p>

<pre><code>from scrapy import cmdline

cmdline.execute(&#39;scrapy crawl baidubaike_spider&#39;.split())
</code></pre>

<p>æ¯æ¬¡ä»è¿™é‡Œé¢è¿è¡Œ.pyå°±è¡Œäº†,ä¸éœ€è¦æ¯æ¬¡éƒ½è¿›åˆ°ç‰¹å®šç›®å½•è¿è¡Œtermianlç»ˆç«¯ç¨‹åºã€‚</p></li>
</ul></li>
</ol>

<h3 id="toc_5">ä¸»è¦çˆ¬è™«ç±»</h3>

<p>douban_spider.py </p>

<pre><code># -*- coding: utf-8 -*-
import scrapy

class DoubanSpiderSpider(scrapy.Spider):
    name = &#39;douban_spider&#39;#çˆ¬è™«å
    allowed_domains = [&#39;movie.douban.com&#39;]
    start_urls = [&#39;https://movie.douban.com/top250&#39;]#å…¥å£url æ‰”åˆ°è°ƒåº¦å™¨é‡Œé¢
    #é»˜è®¤çš„è§£ææ–¹æ³•
    def parse(self, response):
    #responseå°±æ˜¯ç½‘ç»œè¯·æ±‚ä¹‹åçš„å“åº”æ•°æ®
    #ä¸»è¦çš„ä»£ç è§£æéƒ½åœ¨è¿™ä¸ªç±»ä¸­è¿›è¡Œ
       pass

</code></pre>

<h3 id="toc_6">HTMLè§£æå™¨</h3>

<p>çˆ¬å–ä¹‹åçš„æ•°æ®å¦‚æœä¸ºhtmlå°±éœ€è¦ç”¨åˆ°htmlè§£æå™¨ï¼Œä¸šç•Œä¸€èˆ¬æœ‰ä¸‰ç§æ–¹å¼è¿›è¡Œè§£æ</p>

<ul>
<li>Beautiifulsoup</li>
<li>æ­£åˆ™åŒ¹é…å¼</li>
<li>lxmlä¸­çš„xpath </li>
</ul>

<p>æœ‰äººåšè¿‡ä¸‰ä¸ªæ–¹æ³•çš„æ¯”è¾ƒï¼Œå¤§è‡´ç»“æœå¦‚ä¸‹</p>

<table>
<thead>
<tr>
<th></th>
<th>lxml</th>
<th>beautifulsoup</th>
<th>re</th>
</tr>
</thead>

<tbody>
<tr>
<td>è¯­æ³•éš¾æ˜“åº¦</td>
<td>ç®€å•</td>
<td>ç®€å•</td>
<td>å¤æ‚</td>
</tr>
<tr>
<td>æŸ¥æ‰¾é€Ÿåº¦</td>
<td>è¾ƒå¿«</td>
<td>æ…¢</td>
<td>æœ€å¿«</td>
</tr>
</tbody>
</table>

<p>æ‰€ä»¥è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯lxmlçš„æ–¹å¼è¿›è¡Œhtmlè§£æï¼Œä¹Ÿæ¨èæ–°æ‰‹ä»è¿™ä¸ªæ–¹å¼å¼€å§‹å…¥é—¨ã€‚</p>

<h4 id="toc_7">lxml</h4>

<p>lxmlæ˜¯é€šè¿‡xpathæ¥æŸ¥æ‰¾ï¼Œä½¿ç”¨å‰éœ€ä½¿ç”¨è°ƒç”¨ertee.HTML()æ–¹æ³•(&#39;()&#39;å†…å¡«HTMLä»£ç )ç”Ÿæˆä¸€ä¸ªå¯æŸ¥æ‰¾çš„å¯¹è±¡ã€‚</p>

<h5 id="toc_8">å¸¸ç”¨xpathè¯­æ³•å¦‚ä¸‹</h5>

<pre><code>// ä¸¤ä¸ªæ–œæ ä¸ºå‘ä¸‹æŸ¥æ‰¾å­™å­æ ‡ç­¾
    
/ ä¸€ä¸ªæ–œæ ä¸ºæŸ¥æ‰¾ç›´æ¥å„¿å­æ ‡ç­¾
    
[] æ–¹æ‹¬å·å†…å¡«æ ‡ç­¾å±æ€§,å¦‚æŸ¥æ‰¾classå±æ€§ä¸ºnameçš„aæ ‡ç­¾,æ ¼å¼ä¸ºa[@class=&quot;name&quot;]
    
/text() å–å‡ºæ ‡ç­¾çš„å†…å®¹,å¦‚æŸ¥æ‰¾ç½‘é¡µä¸­çš„ &lt;a class=&quot;name&quot;&gt;KAINHUCK&lt;/a&gt; ä¸­çš„KAINHUCK,æ ¼å¼ä¸º//a[@class=&quot;name&quot;]/text()
    
/@attr å–å‡ºæ ‡ç­¾çš„å±æ€§,å¦‚æŸ¥æ‰¾ç½‘é¡µä¸­çš„ &lt;a class=&quot;name&quot;&gt;KAINHUCK&lt;/a&gt; ä¸­çš„classå±æ€§å€¼name,æ ¼å¼ä¸º//a[@class=&quot;name&quot;]/@class 

</code></pre>

<h5 id="toc_9">xpath å¦‚ä½•æå–å‡ºdivä¸‹é¢æ‰€æœ‰æ ‡ç­¾çš„æ–‡æœ¬å†…å®¹</h5>

<p>æœ‰æ—¶å€™ä¸€ä¸ªdivæ ‡ç­¾ä¸‹ä¼šæœ‰ä¸åŒçš„æ ‡ç­¾ï¼Œå¦‚æœåªæ˜¯å•çº¯çš„ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œå¹¶ä¸èƒ½æå–åˆ°divä¸‹é¢çš„æ‰€æœ‰æ–‡æœ¬å†…å®¹ï¼Œæ‰€ä»¥xpathæä¾›äº†string(.)æ–¹æ³•ã€‚</p>

<pre><code>title = html.xpath(&#39;//dd[@class=&quot;lemmaWgt-lemmaTitle-title&quot;]/h1/text()&#39;)[0]

summary = html.xpath(&#39;//div[@class=&quot;lemma-summary&quot;]&#39;)[0].xpath(&#39;string(.)&#39;).strip()

#stripæ–¹æ³•è¿”å›ç§»é™¤å­—ç¬¦ä¸²å¤´å°¾æŒ‡å®šçš„å­—ç¬¦ç”Ÿæˆçš„æ–°å­—ç¬¦ä¸²ã€‚    
</code></pre>

<h4 id="toc_10">åˆ†ææŠ“å–ç½‘ç«™çš„htmlæ ‡ç­¾</h4>

<p>è¿›å…¥chromeæ‰“å¼€å¼€å‘è€…è°ƒè¯•å·¥å…·</p>

<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1g3kate3mbuj30w00h3n21.jpg" alt=""/></p>

<p>å¦å¤–è¦ä½¿ç”¨lxmlçš„æ–¹å¼è¿›è¡Œè§£æï¼Œå¯ä»¥å®‰è£…æ’ä»¶è¿›è¡ŒæŸ¥æ‰¾ï¼Œåˆ°chromeçš„å•†åŸä¸‹è½½xpathï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥çœ‹åˆ°ç»“æœäº†ï¼Œä»¥é˜²æŠ“å–åˆ°çš„æ ‡ç­¾å‡ºé”™ã€‚</p>

<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1g3kavur7ggj30vt0h0q8t.jpg" alt=""/></p>

<pre><code>//div[@class=&quot;article&quot;]//ol[@class=&quot;grid_view&quot;]/li
</code></pre>

<p>è¿™æ®µè¯­æ³•ç”¨äºæ‰¾åˆ°classä¸ºarticleçš„divæ ‡ç­¾ä¸‹çš„classä¸ºgrid_viewçš„olçš„å­å­™æ ‡ç­¾ä¸‹çš„liæ ‡ç­¾ã€‚</p>

<p>æŸ¥æ‰¾å‡ºæ¥çš„ç»“æœæ˜¯ä¸ªåŒ…å«25ä¸ªå…ƒç´ çš„list</p>

<h3 id="toc_11">ä»£ç ç¼–å†™</h3>

<p>ç„¶åè¿›å…¥åˆ°æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œå¯¼å…¥lxmlå·¥å…·ï¼Œä»¥åŠDoubanItem</p>

<pre><code># -*- coding: utf-8 -*-
import scrapy
from lxml import etree
from douban.items import DoubanItem


class DoubanSpiderSpider(scrapy.Spider):
    name = &#39;douban_spider&#39;#çˆ¬è™«å
    allowed_domains = [&#39;movie.douban.com&#39;]
    start_urls = [&#39;https://movie.douban.com/top250&#39;]#å…¥å£url æ‰”åˆ°è°ƒåº¦å™¨é‡Œé¢
    #é»˜è®¤çš„è§£ææ–¹æ³•
    def parse(self, response):
        #å¾ªç¯ç”µå½±çš„æ¡ç›®
        html = etree.HTML(response.text)
        movie_list = html.xpath(&#39;//div[@class=&quot;article&quot;]//ol[@class=&quot;grid_view&quot;]/li&#39;)
        for item in movie_list:
            #itemæ–‡ä»¶å¯¼å…¥
            douban_item = DoubanItem()
            #å†™è¯¦ç»†çš„xpath è¿›è¡Œæ•°æ®çš„è§£æ
            douban_item[&#39;serial_number&#39;] = item.xpath(&#39;.//div[@class=&quot;item&quot;]//em/text()&#39;)[0]
            douban_item[&#39;movie_name&#39;] = item.xpath(&#39;.//div[@class=&quot;info&quot;]//a/span[1]/text()&#39;)[0]
            content_list = item.xpath(&#39;.//div[@class=&quot;info&quot;]//div[@class=&quot;bd&quot;]/p[1]/text()&#39;)
            for content in content_list:
                content_s = &quot;&quot;.join(content.split())
                douban_item[&#39;introduce&#39;] = content_s

            douban_item[&#39;star&#39;]= item.xpath(&#39;.//div[@class=&quot;star&quot;]/span[@class=&quot;rating_num&quot;]/text()&#39;)[0]
            douban_item[&#39;comment&#39;] = item.xpath(&#39;.//div[@class=&quot;star&quot;]/span[4]/text()&#39;)[0]
            douban_item[&#39;description&#39;] = item.xpath(&#39;.//p[@class=&quot;quote&quot;]/span[1]/text()&#39;)[0]
            print(douban_item)
            yield douban_item #yeildåˆ°piplinesé‡Œé¢ è¿›è¡Œæ•°æ®æ¸…æ´— æ•°æ®å­˜å‚¨
        
        #è§£æä¸‹ä¸€é¡µè§„åˆ™ è·å–åä¸€é¡µçš„xpath
        next_link = html.xpath(&#39;//span[@class=&quot;next&quot;]/link/@href&#39;)

        if next_link:
            next_link = next_link[0]
            #yeildåˆ°è°ƒåº¦å™¨å½“ä¸­ åé¢ç»™äº†å›è°ƒå‡½æ•°
            yield scrapy.Request(&#39;https://movie.douban.com/top250&#39;+next_link,callback=self.parse)

</code></pre>

<p>å…¶ä¸­é‡è¦çš„æœ‰yieldæ–¹æ³•ï¼ŒæŠŠæˆ‘ä»¬ç”Ÿæˆçš„modelç±»ä¼ è¾“åˆ°piplinesé‡Œé¢è¿›è¡Œæ•°æ®çš„å­˜å‚¨ã€‚</p>

<p>è¿˜æœ‰å°±æ˜¯å› ä¸ºè¿™åªæ˜¯ä¸€é¡µçš„æ•°æ®ï¼Œæƒ³è¦æŠ“å–çš„250æ¡æ•°æ®ï¼Œé‚£å°±è¦è¿›è¡Œå¤šæ¬¡æŠ“å–ï¼Œè¿›è¿‡åˆ†æå‘ç°åªéœ€è¦æ¯æ¬¡æŠŠåé¡µçš„aæ ‡ç­¾çš„hrefæ‹¿åˆ°å°±å¯ä»¥äº†ï¼Œé€šè¿‡xpathè¿›è¡Œè§£æå°±æ˜¯ </p>

<pre><code>#è§£æä¸‹ä¸€é¡µè§„åˆ™ è·å–åä¸€é¡µçš„xpath
        next_link = html.xpath(&#39;//span[@class=&quot;next&quot;]/link/@href&#39;)

</code></pre>

<p>æœ€å¥½éœ€è¦yeildåˆ°è°ƒåº¦å™¨å½“ä¸­ï¼Œå› ä¸ºæ˜¯éƒ¨åˆ†è·¯å¾„ï¼Œæ‰€ä»¥è¦å…ˆè¿›è¡Œè·¯å¾„çš„æ‹¼æ¥ï¼Œè¿˜è¦æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œå°±æ˜¯è¯·æ±‚ä¹‹åè¿›å…¥çš„å›è°ƒæ–¹æ³•ã€‚</p>

<h3 id="toc_12">æ•°æ®å¯¼å‡º</h3>

<p>åœ¨spidersæ–‡ä»¶å¤¹ä¸‹æ–°å»ºoutputdata.py </p>

<pre><code>#æ•°æ®å¯¼å‡º ä¹Ÿå¯ä»¥ä½¿ç”¨terminal ç›´æ¥è¿è¡Œ
from scrapy import cmdline
#æ•°æ®å¯¼å‡ºåˆ°json
# cmdline.execute(&#39;scrapy crawl douban_spider -o output.json&#39;.split())

#æ•°æ®å¯¼å‡ºåˆ°csvæ ¼å¼
cmdline.execute(&#39;scrapy crawl douban_spider -o output.csv&#39;.split())
</code></pre>

<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1g3kbfcz850j30os0jf0y5.jpg" alt=""/></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/5/29</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Spiders.html'>Spiders</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15583189073141.html">
                
                  <h1>Djangoå…¥é—¨ â€” å»ºç«‹ç®€æ˜“åšå®¢ä»¥åŠORMå…³ç³»ä»‹ç»</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<ul>
<li>å¼€æºçš„Python Webæ¡†æ¶</li>
<li>MVCæ¨¡å¼</li>
</ul>

<blockquote>
<p>è¦æƒ³ä½¿ç”¨Django å¿…é¡»å…ˆå®‰è£…Pythonï¼Œæ¨èå®‰è£…3.0ç‰ˆæœ¬ä»¥ä¸Šçš„Python3<br/>
ç„¶åå†ç”¨pipå®‰è£…å·¥å…·å®‰è£…Django<br/>
ç”±äºæˆ‘è¦å®‰è£…åœ¨python3 æ‰€ä»¥æˆ‘çš„pipå·¥å…·ä¹Ÿæ˜¯pip3<br/>
å®‰è£…å‘½ä»¤<code>pip3 install django==2.0</code><br/>
æœ€åé€‰æ‹©é€‚åˆè‡ªå·±çš„IDE<br/>
æˆ‘ä½¿ç”¨çš„æ˜¯VSCode</p>
</blockquote>

<h2 id="toc_0">ä¼˜ç‚¹</h2>

<ul>
<li>å¼€å‘æ•ˆç‡é«˜</li>
<li>åŠŸèƒ½å¼ºå¤§ï¼Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹æ’ä»¶</li>
<li>é‡è§†å®‰å…¨ï¼Œé¿å…å®‰å…¨æ¼æ´</li>
</ul>

<p>å‘½ä»¤è¯­å¥django-admin æ£€æŸ¥djangoæ˜¯å¦æˆåŠŸå®‰è£…ã€‚</p>

<p><img src="media/15583189073141/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-05-20%20%E4%B8%8A%E5%8D%8811.19.16.png" alt="å±å¹•å¿«ç…§ 2019-05-20 ä¸Šåˆ11.19.16"/>ï¿¼</p>

<ul>
<li>startproject # åˆ›å»ºä¸€ä¸ªdjangoé¡¹ç›®</li>
<li>startapp # åˆ›å»ºä¸€ä¸ªdjangoåº”ç”¨</li>
<li>check # æ£€éªŒé¡¹ç›®å®Œæ•´æ€§</li>
<li>runserver # æœ¬åœ°ç®€æ˜“è¿è¡Œdjangoé¡¹ç›®</li>
<li>shell # è¿›å…¥djangoé¡¹ç›®çš„python shellç¯å¢ƒ</li>
<li>test # æ‰§è¡Œdjangoç”¨ä¾‹æµ‹è¯•</li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                   <a href="15583189073141.html">Read more</a>&nbsp;&nbsp; 
                    <span class="date">2019/5/20</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Django.html'>Django</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15578899295258.html">
                
                  <h1>PromiseKit</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2 id="toc_0">then and done</h2>

<p>ä¸€ä¸ªå…¸å‹çš„é“¾æ¡â›“ï¸</p>

<pre><code>firstly {
    login()
}.then { creds in
    fetch(avatar: creds.user)
}.done { image in
    self.imageView = image
}
</code></pre>

<p>å¦‚æœè¿™æ®µä»£ç ä½¿ç”¨ä¹‹å‰çš„æ–¹å¼å¯èƒ½ä¼šæ˜¯è¿™æ ·</p>

<pre><code>login { creds, error in
    if let creds = creds {
        fetch(avatar: creds.user) { image, error in
            if let image = image {
                self.imageView = image
            }
        }
    }
}
</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                   <a href="15578899295258.html">Read more</a>&nbsp;&nbsp; 
                    <span class="date">2019/5/15</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15572343607934.html">
                
                  <h1>RunLoop</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>Fundation æ¡†æ¶æ˜¯å¯¹Core Fundationçš„å°è£…ã€‚</p>

<h2 id="toc_0">Fundation</h2>

<p><code>[NSRunLoop currentRunLoop];</code>//è¿”å›å½“å‰çº¿ç¨‹çš„RunLoop  å¦‚æœä¸å­˜åœ¨å°±ä¼šåˆ›å»ºä¸€ä¸ªRunLoopå¹¶è¿”å›ã€‚<br/>
//If a run loop does not yet exist for the thread, one is created and returned.</p>

<p><code>[NSRunLoop mainRunLoop]</code>//è·å–ä¸»çº¿ç¨‹çš„RunLoopå¯¹è±¡ã€‚</p>

<p>åŸºç¡€çŸ¥è¯†:æ¯ä¸ªçº¿ç¨‹ä¸Šéƒ½å¯¹åº”æœ‰ä¸€ä¸ªRunLoopå¯¹è±¡ï¼Œä¸»çº¿ç¨‹RunLoopé»˜è®¤å¼€å¯ï¼Œå­çº¿ç¨‹RunLoopè¦æ‰‹åŠ¨å¼€å¯ã€‚<br/>
RunLoopåœ¨çº¿ç¨‹ç»“æŸçš„æ—¶å€™é€€å‡ºå¾ªç¯ã€‚</p>
                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                   <a href="15572343607934.html">Read more</a>&nbsp;&nbsp; 
                    <span class="date">2019/5/7</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15554977521883.html">
                
                  <h1>Swiftå•ä¾‹å†™æ³•</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>ä»‹ç»swiftçš„å•ä¾‹ç±»å†™æ³•ä¹‹å‰ï¼Œå¯ä»¥å…ˆå›é¡¾ä¸€ä¸‹ocä¸­å•ä¾‹çš„å†™æ³•å¦‚ä¸‹ã€‚</p>

<pre><code class="language-//é¦–å…ˆ.hæ–‡ä»¶é‡Œå£°æ˜">//å•ä¾‹ç±»
@interface Manger : NSObject
+ (instancetype)sharedManger;
@end

//ç„¶å.mæ–‡ä»¶é‡Œå†™å®ç°
@implementation Manger
+ (instancetype)sharedManger {
    static Manger *sharedManger = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
        sharedManger = [self new];
    });
    return sharedManger;
}

</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                   <a href="15554977521883.html">Read more</a>&nbsp;&nbsp; 
                    <span class="date">2019/4/17</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15554962348970.html">
                
                  <h1>Filter, Map, Reduce  Functions</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h3 id="toc_0">Filter</h3>

<p>Filter å‡½æ•°æ˜¯è¿‡æ»¤å‡ºæ‰€æœ‰ç¬¦åˆè¿‡æ»¤æ¡ä»¶çš„å…ƒç´  </p>

<p>æ¯”å¦‚ä¸‹é¢çš„æ–¹æ³•è¿‡æ»¤å‡ºæ•°ç»„æ‰€æœ‰å…ƒç´ ç­‰äº3çš„å…ƒç´ </p>

<pre><code>func filter() {
        let numbers = [1,2,3,3,3,4]
        //è¿‡æ»¤å‡ºæ‰€æœ‰å…ƒç´ ä¸º3çš„å…ƒç´  å¹¶è¿”å›è¿‡æ»¤ä¹‹åçš„æ•°æ®
        let filtedNumbers = numbers.filter({return $0 == 3})
        print(filtedNumbers)//[3,3,3]
    }

</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                   <a href="15554962348970.html">Read more</a>&nbsp;&nbsp; 
                    <span class="date">2019/4/17</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15553216469263.html">
                
                  <h1>Swiftä¸­çš„å­—å…¸è½¬æ¨¡å‹æ–¹æ³•çš„è¿­ä»£</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>æ¨¡å‹å¯ä»¥æ˜¯ç»“æ„ä½“ä¹Ÿå¯ä»¥æ˜¯ç»§æ‰¿è‡ªNSObjectçš„ç±»  </p>

<pre><code>class App: NSObject {
    var name:String = &quot;&quot;
    var age:Int = 0
    var boxDescription:String = &quot;&quot;
}


struct App :Decodable{
    var name:String
    var age:Int
    var description:String
    
    init(dic:[String:AnyObject]) {
        name = dic[&quot;name&quot;] as! String
        age = dic[&quot;age&quot;] as! Int
        description = dic[&quot;description&quot;] as! String
    }
    
}

</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                   <a href="15553216469263.html">Read more</a>&nbsp;&nbsp; 
                    <span class="date">2019/4/15</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15553140637126.html">
                
                  <h1>Speed Up Development with Xcode File Templates</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4 id="toc_0">Custom Templates Directory</h4>

<ul>
<li><p>~/Library/Developer/Xcode/Templates<br/>
è¿›å…¥åˆ°æŒ‡å®šçš„æ¨¡ç‰ˆè·¯å¾„</p></li>
<li><p>mkdir -p ~/Library/Developer/Xcode/Templates/File\ Templates/Custom åˆ›å»ºä¸€ä¸ªCustom çš„æ–‡ä»¶å¤¹</p></li>
</ul>

<h5 id="toc_1">Xcode Default Templates Directory</h5>

<p>/Applications/Xcode.app/Contents/Developer/Library/Xcode/Templates/File Templates</p>

<p>è¿›å…¥ä¹‹åå¤åˆ¶ä¸€äº›å…¶ä»–çš„æ¨¡ç‰ˆåˆ°è‡ªå·±çš„customæ¨¡ç‰ˆ ç„¶åè¿›å…¥æ¨¡ç‰ˆä¹‹åç¼–è¾‘è‡ªå·±ç»å¸¸ä½¿ç”¨çš„æ¨¡ç‰ˆï¼Œå¯ä»¥æå¤§çš„æå‡å¼€å‘çš„æ•ˆç‡ã€‚</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/4/15</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='iOS.html'>iOS</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
              


			<div class="row">
			  <div class="large-6 columns">
			  <p class="text-left" style="padding-top:25px;">
			   
			  </p>
			  </div>
			  <div class="large-6 columns">
			<p class="text-right" style="padding-top:25px;">
			 <a href="all_1.html">&raquo; Next Page</a> 
			</p>
			  </div>
			</div>
		</div>
	</div><!-- large 8 -->

 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="/asset/img/logo.png" /></div>
            
                <h1>Code Log ğŸ‘¨â€ğŸ’»â€ </h1>
                <div class="site-des"></div>
                <div class="social">









<a target="_blank" class="github" target="_blank" href="https://github.com/maweefeng" title="GitHub">GitHub</a>
<a target="_blank" class="email" href="mailto:maweefeng@gmail.com" title="Email">Email</a>
  <!-- <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a> -->
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="iOS.html"><strong>iOS</strong></a>
        
            <a href="Git.html"><strong>Git</strong></a>
        
            <a href="CocoaPods.html"><strong>CocoaPods</strong></a>
        
            <a href="Django.html"><strong>Django</strong></a>
        
            <a href="Spiders.html"><strong>Spiders</strong></a>
        
            <a href="about.html"><strong>about</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="15590976892074.html">Scrapy æŠ“å–ç½‘é¡µæ•°æ®</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15583189073141.html">Djangoå…¥é—¨ â€” å»ºç«‹ç®€æ˜“åšå®¢ä»¥åŠORMå…³ç³»ä»‹ç»</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15578899295258.html">PromiseKit</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15572343607934.html">RunLoop</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15554977521883.html">Swiftå•ä¾‹å†™æ³•</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <!-- <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p> -->
<p class="copyright">æ—¥å…‰ä¹‹ä¸‹ æ°¸æ— æ–°äº‹</p>
</div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
